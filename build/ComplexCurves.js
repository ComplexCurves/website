/**
 * @license
 *
 * Complex Curves
 *
 * Copyright 2016 Stefan Kranich
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(function(){
'use strict';var k,l={"Assembly.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D samplers[1 + N/2];\nvarying float sheet;\nvarying float which;\nvarying vec2 texCoord[3];\n\nvoid readTex (out vec2 pos[3], out float delta[3], out vec2 values[3*N]) {\nvec4 s;\nfor (int i = 0; i < 3; i++) {\ns = texture2D (samplers[0], texCoord[i]);\npos[i] = s.xy;\ndelta[i] = s.z;\nfor (int j = 1; j < N/2; j++) {\ns = texture2D (samplers[j], texCoord[i]);\nvalues[i*N+2*j-2] = s.xy;\nvalues[i*N+2*j-1] = s.zw;\n}\n}\n}\n\nbool valid (in vec2 position[3], in float delta[3]) {\nreturn distance (position[0], position[1]) < min (delta[0], delta[1])\n&& distance (position[1], position[2]) < min (delta[1], delta[2])\n&& distance (position[2], position[0]) < min (delta[2], delta[0]);\n}\n\nvoid main(void) {\nint isheet = int(sheet);\nif (isheet < sheets) {\nvec2 pos[3];\nfloat delta[3];\nvec2 values[3*N];\nreadTex (pos, delta, values);\nif (valid (pos, delta)) {\nfor (int s = 0; s < sheets; s++) {\nif (s == isheet) {\nvec2 valueA = values[s];\nint iwhich = int(which);\nfor (int w = 0; w < 3; w++) {\nif (w == iwhich) {\nvec2 valueWhich = values[w*N];\nfloat dist, minDist = distance (valueA, valueWhich);\nfor (int i = 1; i < sheets; i++) {\ndist = distance (valueA, values[w*N+i]);\nif (dist < minDist)\n{\nvalueWhich = values[w*N+i];\nminDist = dist;\n}\n}\ngl_FragColor = vec4(pos[w], valueWhich);\n}\n}\n}\n}\nreturn;\n}\n}\ngl_FragColor = vec4(-10.0, -10.0, -10.0, 1.0);\n}\n",
"Assembly.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute float index;\nuniform float numIndices;\nvarying float sheet;\nvarying vec2 texCoord[3];\nvarying float which;\n\nvoid main (void) {\ngl_Position = indexedPosition (index);\nsheet = floor (index / numIndices);\nfloat j = mod (index, 3.0);\ntexCoord[0] = uvPosition (mod (index - j, numIndices));\ntexCoord[1] = uvPosition (mod (index - j + 1.0, numIndices));\ntexCoord[2] = uvPosition (mod (index - j + 2.0, numIndices));\nwhich = j;\n}\n",
"CachedSurface.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform bool clipping;\nvarying vec4 vPos;\nvarying vec2 vValue;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nif (clipping && vPos.y < 0.0)\ndiscard;\nfloat PI = acos (-1.0);\nfloat angle = atan (vValue.y, vValue.x);\nfloat blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\nfloat blackm = sawfct (log (length (vValue)), PI / 12.0, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb (angle), gl_FragCoord.z);\n}\n",
"CachedSurface.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec4 position;\nuniform mat4 m, v, p;\nvarying vec4 vPos;\nvarying vec2 vValue;\nvoid main (void)\n{\nvPos = vec4 (position.xyz, 1.0);\nvValue = position.zw;\ngl_Position = p * v * m * vPos;\n}\n","Common.glsl":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#define EPS 5e-3\n\n/* complex division */\nvec2 cd (in vec2 a, in vec2 b) {\n\treturn vec2 (a.x * b.x + a.y * b.y, a.y * b.x - a.x * b.y) / dot (b, b);\n}\n\nvec2 cinv (in vec2 z) {\nreturn vec2(z.x, -z.y) / dot(z, z);\n}\n\n/* complex square root */\nvec2 csqrt (in vec2 z)\n{\nfloat r = sqrt (length (z));\nfloat phi = 0.5 * atan (z.y, z.x);\nreturn r * vec2 (cos (phi), sin (phi));\n}\n\nvec2 horner (in int n, in vec2 cs[N+1], in vec2 x) {\nvec2 p;\nfor (int i = N - 1; i >= 0; i--)\nif (i >= n)\np = cs[i];\nelse if (i < n)\np = cs[i] + cm(p, x);\nreturn p;\n}\n\nvoid weierstrass (in vec2 cs[N+1], out vec2 roots2[N]) {\n\t/* polynomial must be monic! */\nvec2 csn = cs[sheets];\nif (csn != vec2 (1.0, 0.0))\nfor (int i = 0; i <= sheets; i++)\ncs[i] = cd (cs[i], csn);\n\nfloat maxabs = length (cs[0]);\nfor (int i = 1; i < N; i++)\nif (i < sheets)\nmaxabs = max (maxabs, length (cs[i]));\nfloat upperBound = 1.0 + maxabs; /// length (cs[n]);\nfloat phi = 2.0 * acos (-1.0) / float (sheets + 1);\nfloat d = upperBound / float (sheets);\nd = clamp (d, 1.0, 10.0);\n\tfor (int i = 0; i < sheets; i++)\nroots2[i] = float (i) * d * vec2 (cos (float (i) * phi), sin (float (i) * phi));\n\n\tconst int maxiter = 50;\n\tbool changing;\n\tfor (int iter = 0; iter < maxiter; iter++)\n\t{\n\t\tchanging = false;\n\t\tfor (int i = 0; i < sheets; i++)\n{\nvec2 result = vec2 (1.0, 0.0);\nfor (int j = 0; j < sheets; j++)\nif (j != i)\nresult = cm (result, roots2[i] - roots2[j]);\nvec2 update = cd (horner (sheets, cs, roots2[i]), result);\n///* safe-guard against large update */\n//if (sheets > 1 && length (update) > 10)\n//\tupdate /= length (update);\nif (length (update) > 1e-2)\nchanging = true;\nroots2[i] -= update;\n}\nif (!changing)\nbreak;\n\t}\n}\n\nvoid quadratic_roots (in vec2 cs[N+1], out vec2 qroots[2]) {\nif (cs[0] == vec2 (0.0, 0.0)) {\nqroots[0] = vec2 (0.0, 0.0);\nqroots[1] = -cd (cs[1], cs[2]);\n}\nelse\n{\nvec2 r = csqrt (cm (cs[1], cs[1]) - 4.0 * cm (cs[2], cs[0]));\nif (cs[1].x >= 0.0)\nr = -r;\nqroots[0] = cd (r - cs[1], 2.0 * cs[2]);\nqroots[1] = cd (2.0 * cs[0], r - cs[1]);\n}\n}\n\nvoid roots (in int n, in vec2 cs[N+1], out vec2 roots[N])\n{\nif (n == 1) {\nroots[0] = -cd (cs[0], cs[1]);\nreturn;\n}\nif (n == 2) {\nvec2 qroots[2];\nquadratic_roots (cs, qroots);\nroots[0] = qroots[0];\nroots[1] = qroots[1];\nreturn;\n}\nweierstrass (cs, roots);\n/* selection sort by real part */\n/*\nfor(int i = 0; i < n - 1; i++)\n{\nint jmin = i;\nfor (int j = i + 1; j < n; j++)\nif (roots[j].x < roots[jmin].x)\njmin = j;\nvec2 z = roots[i];\nroots[i] = roots[jmin];\nroots[jmin] = z;\n}\n*/\n}\n\nvoid f (in vec2 x, out vec2 cs[N+1]);\nvec2 fx (in vec2 x, in vec2 y);\nvec2 fy (in vec2 x, in vec2 y);\nfloat rho (in vec2 x);\nfloat M (in vec2 x, in float rho);\n\nfloat epsilon (in vec2 ys[N]) {\nfloat d = distance (ys[0], ys[1]);\nfor (int j = 0; j < sheets; j++) {\nfor (int k = 0; k < sheets; k++) {\nif (k > j)\nd = min (d, distance (ys[j], ys[k]));\n}\n}\nreturn d / 2.0;\n}\n\nfloat Y (in vec2 x, in vec2 ys[N]) {\nfloat y = length (cd (fx (x, ys[0]), fy (x, ys[0])));\nfor (int j = 0; j < sheets; j++)\ny = max (y, length (cd (fx (x, ys[j]), fy (x, ys[j]))));\nreturn y;\n}\n\nfloat Delta (in vec2 x, in vec2 ys[N]) {\nfloat eps = epsilon (ys);\nfloat r = rho (x);\nfloat m = M (x, r);\nfloat y = Y (x, ys);\nreturn r * (sqrt (pow (r * y - eps, 2.0) + 4.0 * eps * m) -\n(r * y + eps)) / (2.0 * (m - r * y));\n}\n",
"DomainColouring.frag":"\nuniform int sheet;\nvarying vec2 vPosition;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nvec2 cs[N+1];\nvec2 ys[N];\nvec2 value;\nf (vPosition, cs);\nroots (sheets, cs, ys);\nint smaller;\nfor (int i = 0; i < sheets; i++)\n{\nsmaller = 0;\nfor (int j = 0; j < sheets; j++)\nif (ys[j].x < ys[i].x)\nsmaller++;\nif (smaller == sheet - 1)\nvalue = ys[i];\n}\n\nfloat PI = acos (-1.0);\nfloat angle = atan (value.y, value.x);\nfloat blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\nfloat blackm = sawfct (log (length (value)), PI / 12.0, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb(angle), 1.0);\n}\n",
"DomainColouring.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec2 position;\nvarying vec2 vPosition;\nvoid main () {\ngl_Position = vec4 (position, 0.0, 1.0);\nvPosition = 5.0 * position;\n}\n","Export.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nvarying vec2 vValue;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nfloat PI = acos (-1.0);\nfloat angle = atan (vValue.y, vValue.x);\nfloat blackp = sawfct (angle / (2.0 * PI), 0.05, 0.7, 1.0);\nfloat blackm = sawfct (log (length (vValue)), 0.1 * PI, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb(angle), 1.0);\n}\n",
"Export.vert":"\nuniform float maxValue;\nuniform float minValue;\nattribute vec2 vPosition;\nvarying vec2 vValue;\n\nvoid main()\n{\ngl_Position = vec4(vPosition, 0.0, 1.0);\nvValue = 0.5 * (maxValue - minValue) * (vPosition + vec2 (1.0, 1.0))\n+ vec2 (minValue, minValue);\n}\n","FXAA.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D u_tex;\nuniform float width;\nuniform float height;\n\n#define FXAA_REDUCE_MIN (1.0/ 128.0)\n#define FXAA_REDUCE_MUL (1.0 / 8.0)\n#define FXAA_SPAN_MAX 8.0\n// from https://github.com/mitsuhiko/webgl-meincraft/blob/master/assets/shaders/fxaa.glsl\nvec4 applyFXAA(in vec2 fragCoord, in sampler2D tex)\n{\nvec4 color;\nvec2 inverseVP = vec2(1.0 / width, 1.0 / height);\nvec3 rgbNW = texture2D(tex, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;\nvec3 rgbNE = texture2D(tex, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;\nvec3 rgbSW = texture2D(tex, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;\nvec3 rgbSE = texture2D(tex, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;\nvec3 rgbM = texture2D(tex, fragCoord * inverseVP).xyz;\nvec3 luma = vec3(0.299, 0.587, 0.114);\nfloat lumaNW = dot(rgbNW, luma);\nfloat lumaNE = dot(rgbNE, luma);\nfloat lumaSW = dot(rgbSW, luma);\nfloat lumaSE = dot(rgbSE, luma);\nfloat lumaM = dot(rgbM, luma);\nfloat lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\nfloat lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\nvec2 dir;\ndir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\ndir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));\nfloat dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n(0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\nfloat rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\ndir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\nmax(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\ndir * rcpDirMin)) * inverseVP;\nvec3 rgbA = 0.5 * (\ntexture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\ntexture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\nvec3 rgbB = rgbA * 0.5 + 0.25 * (\ntexture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\ntexture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\nfloat lumaB = dot(rgbB, luma);\nif ((lumaB < lumaMin) || (lumaB > lumaMax))\ncolor = vec4(rgbA, 1.0);\nelse\ncolor = vec4(rgbB, 1.0);\nreturn color;\n}\n\nvoid main (void)\n{\ngl_FragColor = applyFXAA(gl_FragCoord.xy, u_tex);\n}\n",
"FXAA.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec2 vPosition;\nvoid main()\n{\ngl_Position = vec4(vPosition, 0.0, 1.0);\n}\n","Initial.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform int computedRoots;\nvarying vec2 texCoord;\nvarying vec2 vPosition;\nvoid main(void) {\nvec2 position = clamp (vPosition, -5.0, 5.0);\nvec2 values[N];\nvec2 cs[N+1];\nf (position, cs);\nroots (sheets, cs, values);\n\nif (computedRoots < sheets) {\nfor (int i = 0; i < N; i += 2) {\nif (i == computedRoots)\nif (computedRoots + 1 < sheets)\ngl_FragColor = vec4(values[i], values[i + 1]);\nelse\ngl_FragColor = vec4(values[i], vec2 (0.0, 0.0));\n}\n} else {\nfloat delta = Delta (position, values);\ngl_FragColor = vec4 (position, delta, 1.0);\n}\n}\n",
"Initial.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute float index;\nattribute vec2 position;\nvarying vec2 texCoord;\nvarying vec2 vPosition;\nvoid main (void) {\nvPosition = position;\ngl_Position = indexedPosition (index);\ntexCoord = uvPosition (index);\n}\n","Subdivision.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform int computedRoots;\nuniform sampler2D oldSamplers[1 + N/2];\nvarying vec3 barycentric;\nvarying vec2 texCoord[3];\nvarying vec2 texCoordOut;\n\nvoid main(void) {\nif (barycentric == vec3 (1.0, 0.0, 0.0)) {\nif (computedRoots >= sheets) {\ngl_FragColor = texture2D (oldSamplers[0], texCoord[0]);\n} else {\nint i = computedRoots / 2 + 1;\nfor (int j = 1; j < 1 + N/2; j++)\nif (j == i)\ngl_FragColor = texture2D (oldSamplers[j], texCoord[0]);\n}\n} else if (barycentric == vec3 (0.0, 1.0, 0.0)) {\nif (computedRoots >= sheets) {\ngl_FragColor = texture2D (oldSamplers[0], texCoord[1]);\n} else {\nint i = computedRoots / 2 + 1;\nfor (int j = 1; j < 1 + N/2; j++)\nif (j == i)\ngl_FragColor = texture2D (oldSamplers[j], texCoord[1]);\n}\n} else if (barycentric == vec3 (0.0, 0.0, 1.0)) {\nif (computedRoots >= sheets) {\ngl_FragColor = texture2D (oldSamplers[0], texCoord[2]);\n} else {\nint i = computedRoots / 2 + 1;\nfor (int j = 1; j < 1 + N/2; j++)\nif (j == i)\ngl_FragColor = texture2D (oldSamplers[j], texCoord[2]);\n}\n} else {\nvec2 values[N];\nvec2 position = barycentric.x * texture2D (oldSamplers[0], texCoord[0]).xy\n+ barycentric.y * texture2D (oldSamplers[0], texCoord[1]).xy\n+ barycentric.z * texture2D (oldSamplers[0], texCoord[2]).xy;\nvec2 cs[N+1];\nf (position, cs);\nroots (sheets, cs, values);\n\nif (computedRoots < sheets) {\nfor (int i = 0; i < N; i += 2) {\nif (i == computedRoots)\nif (computedRoots + 1 < sheets)\ngl_FragColor = vec4(values[i], values[i + 1]);\nelse\ngl_FragColor = vec4(values[i], vec2 (0.0, 0.0));\n}\n} else {\nfloat delta = Delta (position, values);\ngl_FragColor = vec4 (position, delta, 1.0);\n}\n}\n}\n",
"Subdivision.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec4 indexBarycentric;\nuniform float indexOffsetIn;\nuniform float indexOffsetOut;\nvarying vec3 barycentric;\nvarying vec2 texCoord[3];\nvarying vec2 texCoordOut;\n\nvoid main (void) {\nfloat indexOut = indexBarycentric.x + indexOffsetOut;\ngl_Position = indexedPosition (indexOut);\nbarycentric = indexBarycentric.yzw;\ntexCoord[0] = uvPosition (indexOffsetIn);\ntexCoord[1] = uvPosition (indexOffsetIn + 1.0);\ntexCoord[2] = uvPosition (indexOffsetIn + 2.0);\ntexCoordOut = uvPosition (indexOut);\n}\n",
"SubdivisionPre.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D sampler;\nvarying vec2 texCoord[2];\n\nbool validOutgoingEdge () {\nvec3 next = texture2D (sampler, texCoord[1]).xyz;\nreturn distance (gl_FragColor.xy, next.xy) < min (gl_FragColor.z, next.z);\n}\n\nvoid main(void) {\ngl_FragColor = texture2D (sampler, texCoord[0]);\nif (gl_FragColor.w == 1.0 && validOutgoingEdge ())\ngl_FragColor.w = 0.0;\n}\n","SubdivisionPre.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute float index;\nvarying vec2 texCoord[2];\n\nvoid main (void) {\ngl_Position = indexedPosition (index);\nfloat j = 1.0;\nif (mod (index, 3.0) > 1.0)\nj = -2.0;\ntexCoord[0] = uvPosition (index);\ntexCoord[1] = uvPosition (index + j);\n}\n",
"Surface.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform bool clipping;\nvarying vec4 vPos;\nvarying vec2 v_value;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nif (clipping && vPos.y < 0.0)\ndiscard;\nfloat PI = acos (-1.0);\nfloat angle = atan (v_value.y, v_value.x);\nfloat blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\nfloat blackm = sawfct (log (length (v_value)), PI / 12.0, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb (angle), gl_FragCoord.z);\n}\n",
"Surface.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform mat4 m;\nuniform mat4 v;\nuniform mat4 p;\nuniform sampler2D sampler;\nattribute float index;\nvarying vec4 vPos;\nvarying vec2 v_value;\nvoid main (void)\n{\nvec4 posValue = texture2D (sampler, uvPosition (index));\nvPos = vec4 (posValue.xyz, 1.0);\nv_value = posValue.zw;\ngl_Position = p * v * m * vPos;\n}\n","Textures.glsl":"\n#define W 2048.0\n#define H 2048.0\nvec2 uvPosition (in float i) {\nconst float h = 2048.0;\nreturn vec2 (mod (i, W) / W + 0.5 / W, floor (i / W) / H + 0.5 / H);\n}\n\nvec4 indexedPosition (in float i) {\nfloat x = mod (i, W) / W;\nfloat y = floor (i / W) / H;\nreturn vec4 (x * 2.0 - 1.0 + 1.0 / W, y * 2.0 - 1.0 + 1.0 / H, 0.0, 1.0);\n}\n"};function t(){}
t.a=function(a){var b=a.type,c=a.value;if("infix"===b){b=t.a(a.first);a=t.a(a.second);if("+"===c)return aa(b,a);if("-"===c)return aa(b,ba(a));if("*"===c)return ca(b,a);if("^"===c){if(da(a)&&(c=ea(a),0<=c.a&&0===c.b))return fa(b,c.a);console.error("Illegal exponent")}else console.error("Infix operator '"+c+"' not implemented")}else if("prefix"===b){b=t.a(a.first);if("+"===c)return b;if("-"===c)return ba(b);console.error("Prefix operator '"+c+"' not implemented")}else{if("number"===b)return new w([new x(z(parseFloat(c)),new A({}))]);
if("variable"===b)return b={},b[c]=1,new w([new x(ga,new A(b))]);if("imaginary"===b)return new w([new x(new B(0,1),new A({}))])}return null};
t.b=function(a){function b(a,c){function b(a,c){return{type:"infix",value:c[0].value,first:a,second:c[1]}}return c===[]?a:c.reduce(b,a)}function c(a){a=C(ha(ia(m,d),d),ja(C(m,d)))(a);return null===a?null:b(a[0],a[1])}function d(a){a=C(e,ja(C(q,e)))(a);return null===a?null:b(a[0],a[1])}function e(a){var b=ha(la(c),g,h,n)(a);if(null===b)return null;a=f(a);return null===a?b:{type:"infix",value:"^",first:b,second:a}}function f(a){var c=C(p,g)(a);if(null===c)return null;a=f(a);return null===a?c[1]:{type:"infix",
value:"^",first:c[1],second:a}}a=ma(a);var g=na("number"),h=na("imaginary"),n=na("variable"),m=ha(D("+"),D("-")),q=D("*"),p=D("^");return function(a){a=C(c,oa)(a);return null===a?null:a[0]}(a)};var E=5/12*Math.PI,F=Math.PI/6;function G(a,b,c,d){b=void 0===b?E:b;c=void 0===c?F:c;this.c=a;b=H(b,c);c=new pa;c.B=void 0===d?!1:d;c.j=c.P=c.s=b;this.a=c;this.b=new qa(a);ra(this)}k=G.prototype;k.oa=function(a){var b=this.b;return b.w.ba(b,void 0===a?!1:a)};k.pa=function(a){var b=this.b;b.w.ca(b,void 0===a?"surface.bin":a)};k.qa=function(a,b){var c=this.b;c.w.da(c,void 0===a?"sheet":a,void 0===b?!0:b)};
k.Ca=function(a,b){a=void 0===a?"surface.png":a;b=void 0===b?!1:b;var c=this,d=this.b;sa(d,function(){I(c)},b);b=J(d,b?d.A:d.v);K(a,ta(b))};k.ra=function(a,b){var c=this.b;c.w.ea(c,void 0===a?"surface":a,void 0===b?!0:b)};
function ra(a){var b=a.c,c=a.a;a.f=function(b){b.preventDefault();c.o||(ua(c,[b.clientX,b.clientY]),I(a))};a.L=function(a){a.preventDefault();va(c,a.clientX,a.clientY)};a.M=function(a){a.preventDefault();c.N=[0,0];c.C=!1};a.ma=function(b){b.preventDefault();b=b.touches[0];ua(c,[b.clientX,b.clientY]);I(a)};a.la=function(a){a.preventDefault();a=a.touches[0];va(c,a.clientX,a.clientY)};a.ka=function(a){a.preventDefault();c.N=[0,0];c.C=!1};a.na=function(b){b.preventDefault();c.F=0<b.deltaY?Math.min(4,
c.F+.1):Math.max(.5,c.F-.1);I(a)};b.addEventListener("mousedown",a.f);b.addEventListener("mousemove",a.L);b.addEventListener("mouseup",a.M);b.addEventListener("touchstart",a.ma);b.addEventListener("touchmove",a.la);b.addEventListener("touchend",a.ka);b.addEventListener("wheel",a.na)}function I(a){var b=a.a;wa(a.b,b);if(b.o||b.C||1E-6<xa(b.j,b.s).abs())ya(b),requestAnimationFrame(function(){I(a)})}k.Da=function(){this.u(Math.PI/2,Math.PI)};k.Ea=function(){this.u(Math.PI,0)};
k.Fa=function(){this.u(E,F)};k.Ga=function(){this.u(Math.PI/2,0)};k.u=function(a,b){this.a.o=!1;this.a.s=this.a.P=this.a.j;this.a.s=H(a,b);I(this)};k.Ha=function(){this.u(Math.PI/2,-Math.PI/2)};k.Ia=function(){this.u(Math.PI/2,Math.PI/2)};k.Ja=function(){this.u(0,0)};k.sa=function(a){this.b.K=a;I(this)};k.ta=function(a){this.a.o=a;I(this)};k.ua=function(a){this.b.J=a;I(this)};k.Ka=function(a,b){a=H(a,b);this.a.o=!1;this.a.C=!1;this.a.j=this.a.s=a;I(this)};k.va=function(a){this.a.B=a;I(this)};
k.wa=function(a){this.b.R=a;I(this)};k.La=function(a){this.a.F=a||1;I(this)};k.xa=function(){var a=this.b;a.K=!a.K;I(this)};k.ya=function(){var a=this.a;a.o=!a.o;I(this)};k.za=function(){var a=this.b;a.J=!a.J;I(this)};k.Aa=function(){var a=this.a;a.B=!a.B;I(this)};k.Ba=function(){var a=this.b;a.R=!a.R;I(this)};
k.Ma=function(){var a=this.c;a.removeEventListener("mousedown",this.f);a.removeEventListener("mousemove",this.L);a.removeEventListener("mouseup",this.M);a.removeEventListener("touchstart",this.ma);a.removeEventListener("touchmove",this.la);a.removeEventListener("touchend",this.ka);a.removeEventListener("wheel",this.na)};window.ComplexCurves=G;G.fromEquation=function(a,b,c,d,e,f){d=void 0===d?E:d;e=void 0===e?F:e;f=void 0===f?!1:f;b=t.a(t.b(b));d=void 0===d?E:d;e=void 0===e?F:e;a=new G(a,d,e,void 0===f?!1:f);f=a.b;f.w=new za(f,b,c);I(a);return a};G.fromFile=function(a,b,c,d,e,f,g){d=void 0===d?E:d;e=void 0===e?F:e;f=void 0===f?!1:f;g=void 0===g?function(){}:g;c=t.a(t.b(void 0===c?"":c));var h=new G(a,d,e,f);a=h.b;a.w=new Aa(a,b,c,function(){I(h);g()});return h};G.prototype.domainColouring=G.prototype.oa;
G.prototype.exportBinary=G.prototype.pa;G.prototype.exportDomainColouring=G.prototype.qa;G.prototype.exportScreenshot=G.prototype.Ca;G.prototype.exportSurface=G.prototype.ra;G.prototype.rotateBack=G.prototype.Da;G.prototype.rotateBottom=G.prototype.Ea;G.prototype.rotateDefault=G.prototype.Fa;G.prototype.rotateFront=G.prototype.Ga;G.prototype.rotateLatLong=G.prototype.u;G.prototype.rotateLeft=G.prototype.Ha;G.prototype.rotateRight=G.prototype.Ia;G.prototype.rotateTop=G.prototype.Ja;
G.prototype.setAntialiasing=G.prototype.sa;G.prototype.setAutorotate=G.prototype.ta;G.prototype.setClipping=G.prototype.ua;G.prototype.setLatLong=G.prototype.Ka;G.prototype.setOrtho=G.prototype.va;G.prototype.setTransparency=G.prototype.wa;G.prototype.setZoom=G.prototype.La;G.prototype.toggleAntialiasing=G.prototype.xa;G.prototype.toggleAutorotate=G.prototype.ya;G.prototype.toggleClipping=G.prototype.za;G.prototype.toggleOrtho=G.prototype.Aa;G.prototype.toggleTransparency=G.prototype.Ba;
G.prototype.unregisterEventHandlers=G.prototype.Ma;window.PolynomialParser=t;t.parse=t.b;function Ba(a,b){var c=M("Assembly");c[0]=[b.D,c[0]].join("\n");c[1]=Ca(b,c[1]);this.a=N(a,c)}Ba.prototype.a=null;
Ba.prototype.l=function(a,b,c){var d=b.i,e=b.m[0];c.useProgram(this.a);c.uniform1f(c.getUniformLocation(this.a,"numIndices"),b.h);b.h*=b.O;Da(b,a);c.vertexAttribPointer(0,1,c.FLOAT,!1,0,0);c.bindFramebuffer(c.FRAMEBUFFER,b.H);c.bindTexture(c.TEXTURE_2D,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,e,0);c.bindTexture(c.TEXTURE_2D,null);a=[];for(var e=0,f=d.length;e<f;e++)c.activeTexture(c.TEXTURE0+e),c.bindTexture(c.TEXTURE_2D,d[e]),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,
c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),a[e]=e;c.uniform1iv(c.getUniformLocation(this.a,"samplers"),a);c.disable(c.DEPTH_TEST);c.viewport(0,0,2048,2048);c.drawArrays(c.POINTS,0,b.h);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0);c.bindFramebuffer(c.FRAMEBUFFER,null);c=b.i;b.i=b.m;b.m=c};function Aa(a,b,c,d){d=void 0===d?function(){}:d;var e=this;e.G=void 0===c?null:c;Ea(e,b,function(){var c=e.W,b=a.g;e.ga=c.byteLength/16;b.enableVertexAttribArray(0);e.X=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,e.X);b.bufferData(b.ARRAY_BUFFER,new Float32Array(c),b.STATIC_DRAW);e.S=N(a,M("CachedSurface"));d()})}k=Aa.prototype;k.ba=function(a,b){return this.G?Fa(this.G,a,void 0===b?!1:b):[]};k.ca=function(a,b){K(void 0===b?"surface.bin":b,this.fa)};
k.da=function(a,b,c){this.G&&Ga(this.G,a,void 0===b?"sheet":b,void 0===c?!0:c)};k.ea=function(a,b,c){b=void 0===b?"surface":b;c=void 0===c?!0:c;Ha(a,new Float32Array(this.W),b,c)};k.fa="";function Ea(a,b,c){a.fa=b;var d=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="arraybuffer";d.onload=function(){a.W=d.response;c()};d.send()}k.G=null;k.W=null;k.X=null;k.S=null;
k.l=function(a,b,c){this.S&&(b.useProgram(this.S),Ia(a),Ja(a,"m",Ka(c.j)),La(a,c),Ma(a,c),Na(a),b.bindBuffer(b.ARRAY_BUFFER,this.X),b.vertexAttribPointer(0,4,b.FLOAT,!1,0,0),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),b.drawArrays(b.TRIANGLES,0,this.ga),Na(a,!1))};k.ga=0;function B(a,b){this.a=a;this.b=b}B.prototype.abs=function(){return Math.sqrt(this.a*this.a+this.b*this.b)};function O(a,b){return new B(a.a+b.a,a.b+b.b)}function P(a,b){var c=b.a*b.a+b.b*b.b;return new B((a.a*b.a+a.b*b.b)/c,(a.b*b.a-a.a*b.b)/c)}B.prototype.b=0;var Oa=new B(Infinity,Infinity);function Q(a,b){return new B(a.a*b.a-a.b*b.b,a.a*b.b+a.b*b.a)}function Pa(a){return new B(-a.a,-a.b)}var ga=new B(1,0);B.prototype.a=0;function z(a){return new B(a,0)}
function Qa(a){if(0===a.a&&0===a.b)return R();var b=a.abs();return new B(Math.sqrt(.5*(b+a.a)),(Math.sign(a.b)||1)*Math.sqrt(.5*(b-a.a)))}function S(a,b){return new B(a.a-b.a,a.b-b.b)}function R(){return new B(0,0)};function Fa(a,b,c){function d(a){e.useProgram(h);e.bindBuffer(e.ARRAY_BUFFER,b.I);e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0);n=e.getUniformLocation(h,"sheet");e.uniform1i(n,a);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);e.drawArrays(e.TRIANGLES,0,3)}c=void 0===c?!1:c;var e=b.g,f=M("DomainColouring"),g=Ra(a);f[1]=[g,l["Common.glsl"],f[1]].join("\n");var h=N(b,f),n,f=T(a);a=V(a,0===f.length?"y":f[f.length-1]);for(var f=[],m=1;m<=a;m++)sa(b,d.bind(null,m),c),g=J(b,c?b.A:b.v),f[m-1]=ta(g);return f}
function K(a,b){var c=document.createElement("a");c.href=b;c.download=a;c.style.display="none";document.body.appendChild(c);c.click();document.body.removeChild(c)}function Ga(a,b,c,d){c=void 0===c?"sheet":c;a=Fa(a,b,void 0===d?!0:d);b=0;for(d=a.length;b<d;b++)K(c+(b+1)+".png",a[b])}
function Ha(a,b,c,d){c=void 0===c?"surface":c;d=void 0===d?!0:d;var e,f,g,h,n,m,q,p=-Infinity,r=Infinity;m=b.byteLength/b.BYTES_PER_ELEMENT/4;var y=[];for(f=0;f<4*m;f+=4)e=b[f],g=b[f+1],h=b[f+2],n=b[f+3],y.push([e,g,h]),r=Math.min(r,Math.min(h,n)),p=Math.max(p,Math.max(h,n));e=p-r;var v=[];for(f=2;f<4*m;f+=4)g=(b[f]-r)/e,h=(b[f+1]-r)/e,v.push([g,h]);b=[];for(f=1;f<=m;f+=3)e=f+1,g=f+2,b.push([f,e,g]);q=y.map(function(a,c){var b=v[c];return y.findIndex(function(c,d){d=v[d];return a[0]===c[0]&&a[1]===
c[1]&&a[2]===c[2]&&b[0]===d[0]&&b[1]===d[1]})});var L=Array.from(new Set(q)),y=L.map(function(a){return y[a]}),v=L.map(function(a){return v[a]});b=b.map(function(a){return a.map(function(a){return L.findIndex(function(c){return c===q[a-1]})+1})});f=y.map(function(a){return"v "+a[0]+" "+a[1]+" "+a[2]});m=v.map(function(a){return"vt "+a[0]+" "+a[1]});b=b.map(function(a){var c=a[0],b=a[1];a=a[2];return"f "+c+"/"+c+" "+b+"/"+b+" "+a+"/"+a});e=["mtllib "+c+".mtl","usemtl surface","s 1"];e=e.concat(f,m,
b);e="data:text/plain,"+encodeURIComponent(e.join("\n"));K(c+".obj",e);var u=a.g,U=N(a,M("Export")),ka;sa(a,function(){u.useProgram(U);u.bindBuffer(u.ARRAY_BUFFER,a.I);u.vertexAttribPointer(0,2,u.FLOAT,!1,0,0);ka=u.getUniformLocation(U,"minValue");u.uniform1f(ka,r);ka=u.getUniformLocation(U,"maxValue");u.uniform1f(ka,p);u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT);u.drawArrays(u.TRIANGLES,0,3)},d);d=J(a,d?a.A:a.v);K(c+".png",ta(d));d=["newmtl surface","map_Kd "+c+".png","illum 0"];d="data:text/plain,"+
encodeURIComponent(d.join("\n"));K(c+".mtl",d)}function ta(a){var b=Math.sqrt(a.length/4),c=document.createElement("canvas");c.width=b;c.height=b;var d=c.getContext("2d"),e=d.createImageData(c.width,c.height);e.data.set(a);d.putImageData(e,0,0);a=document.createElement("canvas");a.width=b;a.height=b;b=a.getContext("2d");b.translate(0,a.height-1);b.scale(1,-1);b.drawImage(c,0,0);return a.toDataURL()};function Sa(a){var b=[],c,d;if(da(a))return[W(ea(a))];if(1===T(a).length)for(a=Ta(a),c=0,d=a.length;c<d;c++)b[c]=W(a[c]);else if(2===T(a).length){c=T(a);var e=c[0];a=X(a,c[1]);c=0;for(d=a.length;c<d;c++)b[c]=Y(e,Sa(a[c]))}return b}function W(a){return"vec2 ("+a.a.toPrecision(8)+", "+a.b.toPrecision(8)+")"}
function Ua(a,b){a=Sa(a).reverse();for(var c=Va-a.length+1,d=W(R()),e=0;e<c;e++)a.push(d);b=["void f (in vec2 "+b+", out vec2 cs[N+1])","{"];for(c=0;c<=Va;c++)b.push("cs["+c+"] = "+a[c]+";");b.push("}");return b.join("\n")}function Wa(a,b,c){a=X(Xa(a,b),c);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=Y(b,Sa(a[e]));return["vec2 fx (in vec2 "+b+", in vec2 "+c+")","{","    return "+Y(c,d)+";","}"].join("\n")}
function Ya(a,b,c){a=X(Xa(a,c),b);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=Y(c,Sa(a[e]));return["vec2 fy (in vec2 "+b+", in vec2 "+c+")","{","    return "+Y(b,d)+";","}"].join("\n")}function Y(a,b){for(var c=b[0],d=1,e=b.length;d<e;d++)c="vec2 (1.0000000, 0.0000000)"===c?a:"vec2 (-1.0000000, 0.0000000)"===c?"-"+a:"cm ("+a+","+c+")","vec2 (0.0000000, 0.0000000)"!==b[d]&&(c+="+"+b[d]);return c}
function Za(a,b,c){var d,e,f,g,h=X(a,c);d=0;for(f=h.length;d<f;d++){var n=h[d].a;e=0;for(g=n.length;e<g;e++){var m=n[e];n[e]=new x(z(m.b.abs()),m.a)}h[d]=new w(n)}d=h[0];d=$a(d,b,V(d,b));a=$a(a,c,V(a,c));a=ab(Ta(a));c=["float M (in vec2 "+b+", in float rho)","{","    vec2 r = vec2 (length ("+b+") + rho, 0.0);","    float a["+h.length+"];","    a[0] = length ("+W(ea(d))+");"];d=0;for(f=a.length;d<f;d++)c.push("    a[0] *= distance ("+b+", "+W(a[d])+") - rho;");d=1;for(f=h.length;d<f;d++)c.push("    a["+
d+"] = length ("+Y("r",Sa(h[d]))+");");c=c.concat(["    float m = a[1] / a[0];","    for (int j = 2; j < "+h.length+"; j++) {","        m = max (m, pow (a[j] / a[0], 1.0 / float (j)));","    }","    return 2.0 * m;","}"]);return c.join("\n")}
function bb(a,b,c){var d=$a(a,c,V(a,c)),e=Xa(a,c);c=cb(c,a,e);e=c.a;a=e.length;0===a&&console.error("matrix must be non-empty");for(var f=0;f<a;f++)e[f].length!==a&&console.error("matrix must be square");f=c;for(e=1;e<a;e++){for(var f=f.a,g=f[0][0].b(),h=[],n=0,m=f.length;n<m;n++){h[n]=[];for(var q=0;q<m;q++)if(q<n)h[n][q]=g;else if(q===n){for(var p=g,r=q+1;r<m;r++)var y=ba(f[r][r]),p=aa(p,y);h[n][q]=p}else h[n][q]=f[n][q]}f=(new db(h)).a;g=c.a;f[0].length!==g.length&&console.error("matrix dimensions must match");
h=[];n=f.length;m=g[0].length;q=f[0][0].b();for(p=0;p<n;p++)for(h[p]=[],r=0;r<m;r++){for(var y=q,v=0,L=f[0].length;v<L;v++)var u=ca(f[p][v],g[v][r]),y=aa(y,u);h[p][r]=y}f=new db(h)}c=f.a[0][0];a=0===a%2?ba(c):c;d=ab(Ta(d));f=ab(Ta(a));e=[];a=0;for(c=d.length;a<c;a++)isFinite(d[a].abs())&&e.push(d[a]);a=0;for(c=f.length;a<c;a++)isFinite(f[a].abs())&&e.push(f[a]);d=["float rho (in vec2 "+b+") {","    float d = 100.0;"];a=0;for(c=e.length;a<c;a++)d.push("    d = min (d, distance ("+b+", "+W(e[a])+"));");
d=d.concat(["    return 0.999 * d;","}"]);return d.join("\n")}var Va=8;
function Ra(a){var b=T(a),c=2>b.length?"x":b[0],b=0===b.length?"y":b[b.length-1];return[["#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif","const int N = "+Va+";","const int sheets = "+V(a,b)+";","\n/* complex multiplication */\nvec2 cm (in vec2 a, in vec2 b)\n{\n    return vec2 (a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);\n}"].join("\n"),Ua(a,c),Wa(a,c,b),Ya(a,c,b),bb(a,c,b),Za(a,c,b)].join("\n\n")};function eb(a,b){var c=fb(),d=a.g;b.h=c.length/2;d.enableVertexAttribArray(0);b.T=d.createBuffer();Da(b,a);d.enableVertexAttribArray(1);this.b=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,this.b);d.bufferData(d.ARRAY_BUFFER,new Float32Array(c),d.STATIC_DRAW);b.H=d.createFramebuffer();c=M("Initial");c[0]=[b.D,c[0]].join("\n");c[1]=Ca(b,c[1]);this.a=N(a,c)}eb.prototype.b=null;eb.prototype.a=null;
eb.prototype.l=function(a,b,c){a=b.i;var d=b.m;c.useProgram(this.a);c.enableVertexAttribArray(0);c.bindBuffer(c.ARRAY_BUFFER,b.T);c.vertexAttribPointer(0,1,c.FLOAT,!1,0,0);c.enableVertexAttribArray(1);c.bindBuffer(c.ARRAY_BUFFER,this.b);c.vertexAttribPointer(1,2,c.FLOAT,!1,0,0);c.bindFramebuffer(c.FRAMEBUFFER,b.H);c.disable(c.DEPTH_TEST);c.viewport(0,0,2048,2048);for(var e=c.getUniformLocation(this.a,"computedRoots"),f=b.O,g,h=0;h<=f+1;h+=2)g=h<f?h/2+1:0,c.bindTexture(c.TEXTURE_2D,d[g]),c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,2048,2048,0,c.RGBA,c.FLOAT,null),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,d[g],0),c.uniform1i(e,h),c.drawArrays(c.POINTS,0,b.h);g=0;for(e=d.length;g<e;g++)c.activeTexture(c.TEXTURE0+g),c.bindTexture(c.TEXTURE_2D,null);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0);c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindBuffer(c.ARRAY_BUFFER,
null);c.disableVertexAttribArray(1);b.i=d;b.m=a};function db(a){this.a=a}db.prototype.a=null;function fb(){for(var a=[],b=-10;10>b;b++)for(var c=-10;10>c;c++)a=0===(b+c)%2?a.concat([b,c,b+1,c,b,c+1,b+1,c,b+1,c+1,b,c+1]):a.concat([b,c,b+1,c+1,b,c+1,b,c,b+1,c,b+1,c+1]);return a.map(function(a){return a/2})};function gb(a,b,c){return a+c*(b-a)};function A(a){this.value=a}function hb(a){var b={};a=a.value;for(var c in a)b[c]=a[c];return new A(b)};function C(a){var b=arguments;return function(a){for(var d,e=[],f=0,g=b.length;f<g;f++)if(d=(0,b[f])(a))e.push(d);else return Array.prototype.unshift.apply(a,e),null;return e}}function la(a){var b=D("("),c=D(")");return function(d){return(d=C(b,a,c)(d))?d[1]:null}}function oa(a){return 0===a.length?!0:null}function na(a){return function(b){return(b[0]||{}).type===a?b.shift():null}}function ja(a){return function(b){for(var c=a(b),d=[];null!==c;)d.push(c),c=a(b);return d}}
function ha(a){var b=arguments;return function(a){for(var d,e=0,f=b.length;e<f;e++)if(d=(0,b[e])(a))return d;return null}}function ia(a,b){return function(c){c=C(a,b)(c);return null===c?null:{type:"prefix",value:c[0].value,first:c[1]}}}function D(a){return function(b){return(b[0]||{}).value===a?b.shift():null}};function w(a){0===a.length?this.a=[new x(R(),new A({}))]:this.a=ib(a)}function aa(a,b){return new w(ib(a.a.concat(b.a)))}function $a(a,b,c){a=a.a;for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e];if((g.a.value[b]||0)===c){var h=hb(g.a);delete h.value[b];d.push(new x(g.b,h))}}return new w(d)}function X(a,b){for(var c=V(a,b),d=[],e=0;e<=c;e++)d[e]=$a(a,b,c-e);return d}
function Ta(a){var b=T(a),c=b.length;1<c&&console.error("Polynomial is not univariate");a=X(a,0<c?b[0]:"x");for(var b=[],c=0,d=a.length;c<d;c++)b[c]=ea(a[c]);return b}function ea(a){var b=R();a=a.a;for(var c=0,d=a.length;c<d;c++){var e=a[c],f=e.a.value;if(null===f||0===Object.keys(f).length)b=O(b,e.b)}return b}function V(a,b){var c=0;a=a.a;for(var d=0,e=a.length;d<e;d++)c=Math.max(c,a[d].a.value[b]||0);return c}
function Xa(a,b){a=a.a;for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d].a,g=f.value[b]||0;if(0<g){var h=Q(a[d].b,z(g)),f=hb(f);f.value[b]=g-1;c.push(new x(h,f))}}return new w(c)}function da(a){return 0===T(a).length&&0!==a.a.length}
function jb(a,b,c){for(var d=a.length-1,e=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288],f,g,h,n,m=1;m<=c;m++){h=R();f=R();g=a[0];for(n=1;n<=d;n++)h=O(f,Q(h,b)),f=O(g,Q(f,b)),g=O(a[n],Q(g,b));if(1E-14>g.abs())break;f=P(f,g);n=Q(f,f);g=S(n,P(Q(z(2),h),g));h=Qa(Q(z(d-1),S(Q(z(d),g),n)));g=O(f,h);f=S(f,h);g.abs()<f.abs()&&(g=f);f=1E-14<g.abs()?P(z(d),g):Q(z(b.abs()+1),new B(Math.cos(m),Math.sin(m)));if(1E-14>f.abs())break;0===m%20&&m<c-19&&(f=Q(f,z(e[Math.floor(m/20)])));b=S(b,f)}return b}
function ca(a,b){a=a.a;b=b.a;for(var c=[],d=0,e=a.length;d<e;d++)for(var f=0,g=b.length;f<g;f++){var h=a[d],n=b[f],m={},q=h.a.value,p=n.a.value,r=void 0;for(r in q)m[r]=q[r]+(p[r]||0);for(r in p)m[r]=p[r]+(q[r]||0);c.push(new x(Q(h.b,n.b),new A(m)))}return new w(ib(c))}function ba(a){a=a.a;for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push(new x(Pa(e.b),e.a))}return new w(b)}
function fa(a,b){var c=new w([new x(z(1),new A({}))]);for(Number.isInteger(b)||console.error("Non-integer power of Polynomial!");0<b;b--)c=ca(c,a);return c}w.prototype.pow=function(a){return fa(this,a)};function kb(a){var b=a[0],c=a[1];a=a[2];if(0===a.a&&0===a.b)return[R(),Pa(P(c,b))];var d=Qa(S(Q(c,c),Q(z(4),Q(b,a))));0<=c.a&&(d=Pa(d));return[P(S(d,c),Q(z(2),b)),P(Q(z(2),a),S(d,c))]}
function ab(a){var b=[],c=a,d=a.length-1;if(0>=d)return[];var e=a[0];if(0===e.a&&0===e.b)return b=ab(a.slice(1)),b.push(Oa),b;if(1===d)b[0]=Pa(P(a[1],a[0]));else if(2===d)b=kb(a);else{for(e=0;e<d-2;e++){b[e]=jb(a,R(),200);b[e]=jb(c,b[e],1);for(var f=b[e],g=[a[0]],h=1,n=a.length-1;h<n;h++)g[h]=O(a[h],Q(g[h-1],f));a=g}c=kb(a);b[d-2]=c[0];b[d-1]=c[1]}return b}
function cb(a,b,c){function d(a){for(var c=[],b=0;b<a;b++)c[b]=lb();return c}function e(a,b){return d(b).concat(a).concat(d(f+g-a.length-b))}var f=V(b,a),g=V(c,a);b=X(b,a);a=X(c,a);c=[];for(var h=0;h<g;h++)c.push(e(b,h));for(b=0;b<f;b++)c.push(e(a,b));return new db(c)}w.prototype.a=null;function T(a){a=a.a;for(var b=[],c={},d=0,e=a.length;d<e;d++){var f=a[d].a.value,g;for(g in f)c[g]||(b.push(g),c[g]=!0)}b.sort();return b}function lb(){return new w([])}w.prototype.b=lb;function Z(a,b,c,d){this.f=a;this.a=b;this.b=c;this.c=d}Z.prototype.abs=function(){return Math.sqrt(this.f*this.f+this.a*this.a+this.b*this.b+this.c*this.c)};function H(a,b){a=-a/2;b=-b/2;return mb(new Z(Math.cos(a),Math.sin(a),0,0),new Z(Math.cos(b),0,0,Math.sin(b)))}function nb(a,b,c){return new Z(gb(a.f,b.f,c),gb(a.a,b.a,c),gb(a.b,b.b,c),gb(a.c,b.c,c))}
function mb(a,b){return new Z(a.f*b.f-a.a*b.a-a.b*b.b-a.c*b.c,a.f*b.a+a.a*b.f+a.b*b.c-a.c*b.b,a.f*b.b-a.a*b.c+a.b*b.f+a.c*b.a,a.f*b.c+a.a*b.b-a.b*b.a+a.c*b.f)}function ob(a){var b=a.abs();return new Z(a.f/b,a.a/b,a.b/b,a.c/b)}function Ka(a){var b=a.f,c=a.a,d=a.b;a=a.c;return[b*b+c*c-d*d-a*a,2*c*d+2*b*a,2*c*a-2*b*d,0,2*c*d-2*b*a,b*b-c*c+d*d-a*a,2*d*a+2*b*c,0,2*c*a+2*b*d,2*d*a-2*b*c,b*b-c*c-d*d+a*a,0,0,0,0,b*b+c*c+d*d+a*a]}function xa(a,b){return new Z(a.f-b.f,a.a-b.a,a.b-b.b,a.c-b.c)};function pa(){}k=pa.prototype;k.o=!1;k.N=[0,0];k.B=!1;k.C=!1;k.j=H(0,0);k.P=H(0,0);k.s=H(0,0);k.F=1;function ua(a,b){a.o||(a.N=b,a.C=!0,a.P=a.s)}function va(a,b,c){if(a.C){var d=a.N;b-=d[0];c=d[1]-c;var d=Math.sqrt(b*b+c*c),e=a.P,f=d/Math.sqrt(1E4+d*d);a.s=ob(nb(e,mb(new Z(100/Math.sqrt(1E4+d*d),-f*c,f*b,0),e),.05))}}function ya(a){if(a.o){var b=ob(new Z(.01,0,0,1)),b=mb(b,b);a.j=a.s=mb(a.j,b)}else a.j=ob(nb(a.j,a.s,.1))};function qa(a){a=this.g=a.getContext("webgl",{preserveDrawingBuffer:!0});a.enable(a.DEPTH_TEST);a=this.g;var b=Math.min(a.getParameter(a.MAX_TEXTURE_SIZE),8192);this.V=b;this.I=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.I);a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),a.STATIC_DRAW);a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0);a.enableVertexAttribArray(0);this.Y=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,this.Y);this.Z=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,
this.Z);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b,b);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.Z);this.A=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.A);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,b,b,0,a.RGBA,a.UNSIGNED_BYTE,null);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.A,0);this.$=a.createFramebuffer();
a.bindFramebuffer(a.FRAMEBUFFER,this.$);this.aa=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,this.aa);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,2048,2048);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.aa);this.v=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.v);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2048,2048,0,a.RGBA,
a.UNSIGNED_BYTE,null);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.v,0);a.bindTexture(a.TEXTURE_2D,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindBuffer(a.ARRAY_BUFFER,null);this.ja=N(this,M("FXAA"))}k=qa.prototype;k.V=8192;k.J=!1;k.K=!0;k.ja=null;function M(a){return[l[a+".vert"],l[a+".frag"]]}k.g=null;
function N(a,b){a=a.g;var c=b[1],d=a.createShader(a.VERTEX_SHADER);a.shaderSource(d,b[0]);a.compileShader(d);a.getShaderParameter(d,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(d));b=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(b,c);a.compileShader(b);a.getShaderParameter(b,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(b));c=a.createProgram();a.attachShader(c,d);a.attachShader(c,b);a.linkProgram(c);a.getProgramParameter(c,a.LINK_STATUS)||console.log(a.getProgramInfoLog(c));a.useProgram(c);
return c}
function J(a,b,c){var d;d=void 0===d?0:d;var e=a.g,f=e.getParameter(e.FRAMEBUFFER_BINDING),g=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,g);e.bindTexture(e.TEXTURE_2D,b);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,b,0);b===a.v?(a=new Uint8Array(16777216),e.readPixels(0,0,2048,2048,e.RGBA,e.UNSIGNED_BYTE,a)):b===a.A?(b=a.V,a=new Uint8Array(4*b*
b),e.readPixels(0,0,b,b,e.RGBA,e.UNSIGNED_BYTE,a)):(a=new Float32Array(16777216),e.readPixels(0,0,2048,2048,e.RGBA,e.FLOAT,a));e.bindTexture(e.TEXTURE_2D,null);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0);e.bindFramebuffer(e.FRAMEBUFFER,f);e.deleteFramebuffer(g);return c?a.subarray(d,d+c):a}k.w=null;function wa(a,b){var c=a.g;pb(a,function(){a.w.l(a,c,b)})}k.I=null;k.Y=null;k.Z=null;k.A=null;k.$=null;k.aa=null;k.v=null;k.R=!1;
function Ia(a){var b=a.g;b.uniform1f(b.getUniformLocation(b.getParameter(b.CURRENT_PROGRAM),"clipping"),a.J?1:0)}function Ma(a,b){var c=a.g,d=c.getParameter(c.VIEWPORT),c=d[2],d=d[3];if(b.B){var e=b.F;b=-7.5*e;var f=-7.5*e,g=7.5*e,e=7.5*e,h=Math.min(d/c,1),c=Math.min(c/d,1),c=[2*h/(g-f),0,0,0,0,2*c/(e-b),0,0,0,0,-.01,0,-h*(g+f)/(g-f),-c*(e+b)/(e-b),-0,1]}else b=1/Math.tan(45*b.F/2*Math.PI/180),c=[b/(0<d?c/d:c),0,0,0,0,b,0,0,0,0,101/-99,-1,0,0,200/-99,0];Ja(a,"p",c)}
function Na(a,b){var c=a.g;a.R&&!1!==b?(c.blendFunc(c.SRC_ALPHA,c.ONE),c.enable(c.BLEND),c.disable(c.DEPTH_TEST)):(c.disable(c.BLEND),c.enable(c.DEPTH_TEST),c.depthFunc(c.LESS))}function Ja(a,b,c){a=a.g;a.uniformMatrix4fv(a.getUniformLocation(a.getParameter(a.CURRENT_PROGRAM),b),!1,c)}function La(a,b){Ja(a,"v",b.B?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-20,1])}
function pb(a,b){if(a.K){sa(a,b);b=a.g;var c=a.ja;b.useProgram(c);var d=b.getUniformLocation(c,"width");b.uniform1f(d,b.canvas.width);d=b.getUniformLocation(c,"height");b.uniform1f(d,b.canvas.height);b.bindBuffer(b.ARRAY_BUFFER,a.I);b.vertexAttribPointer(0,2,b.FLOAT,!1,0,0);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,a.v);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.drawArrays(b.TRIANGLES,0,3)}else b()}
function sa(a,b,c){var d=a.g;(void 0===c?0:c)?(c=a.V,d.bindFramebuffer(d.FRAMEBUFFER,a.Y),d.viewport(0,0,c,c)):(d.bindFramebuffer(d.FRAMEBUFFER,a.$),d.viewport(0,0,2048,2048));b();d.viewport(0,0,d.canvas.width,d.canvas.height);d.bindFramebuffer(d.FRAMEBUFFER,null)};function qb(a,b){var c=M("Subdivision");c[0]=[b.D,c[0]].join("\n");c[1]=Ca(b,c[1]);this.a=N(a,c)}qb.prototype.a=null;
qb.prototype.l=function(a,b,c){var d,e,f=b.i,g=b.m,h=this.a;c.useProgram(h);a=J(a,f[0]);var n=[0,3,9,15,24,30,39,48],m=[3,6,6,9,6,9,9,12],q=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,q);c.bufferData(c.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,0,2,0,0,1,0,1,0,0,1,0,1,0,2,.5,0,.5,3,0,1,0,4,0,0,1,5,.5,0,.5,0,1,0,0,1,0,1,0,2,0,.5,.5,3,0,.5,.5,4,0,0,1,5,1,0,0,0,1,0,0,1,0,1,0,2,.5,0,.5,3,0,.5,.5,4,0,0,1,5,.5,0,.5,6,.5,0,.5,7,0,1,0,8,0,.5,.5,0,1,0,0,1,.5,.5,0,2,0,0,1,3,0,0,1,4,.5,.5,0,5,0,1,0,0,1,0,
0,1,.5,.5,0,2,.5,0,.5,3,.5,0,.5,4,.5,.5,0,5,0,0,1,6,0,1,0,7,0,0,1,8,.5,.5,0,0,1,0,0,1,.5,.5,0,2,0,.5,.5,3,0,0,1,4,1,0,0,5,0,.5,.5,6,0,.5,.5,7,.5,.5,0,8,0,1,0,0,1,0,0,1,.5,.5,0,2,.5,0,.5,3,.5,.5,0,4,0,1,0,5,0,.5,.5,6,0,.5,.5,7,0,0,1,8,.5,0,.5,9,.5,.5,0,10,0,.5,.5,11,.5,0,.5]),c.STATIC_DRAW);c.vertexAttribPointer(0,4,c.FLOAT,!1,0,0);c.bindFramebuffer(c.FRAMEBUFFER,b.H);var p=[];d=0;for(e=f.length;d<e;d++)c.activeTexture(c.TEXTURE0+d),c.bindTexture(c.TEXTURE_2D,f[d]),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,
c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),p[d]=d;c.uniform1iv(c.getUniformLocation(h,"oldSamplers"),p);c.disable(c.DEPTH_TEST);c.viewport(0,0,2048,2048);e=c.getUniformLocation(h,"indexOffsetIn");for(var p=c.getUniformLocation(h,"indexOffsetOut"),r=c.getUniformLocation(this.a,"computedRoots"),y=b.O,v=h=0;v<=y+1;v+=2){d=v<y?v/2+1:0;c.bindTexture(c.TEXTURE_2D,
g[d]);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,2048,2048,0,c.RGBA,c.FLOAT,null);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,g[d],0);c.uniform1i(r,v);d=h=0;for(var L=b.h/3;d<L;d++){c.uniform1f(e,3*d);c.uniform1f(p,h);var u=4*a[12*d+3]+2*a[12*d+7]+a[12*d+11],U=m[u];c.drawArrays(c.POINTS,n[u],U);h+=U}}c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,
null,0);d=0;for(e=f.length;d<e;d++)c.activeTexture(c.TEXTURE0+d),c.bindTexture(c.TEXTURE_2D,null);c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindBuffer(c.ARRAY_BUFFER,null);c.deleteBuffer(q);b.h=h;b.i=g;b.m=f};function rb(a,b){var c=M("SubdivisionPre");c[0]=[b.D,c[0]].join("\n");this.a=N(a,c)}rb.prototype.a=null;
rb.prototype.l=function(a,b,c){var d=b.i[0],e=b.m[0];c.useProgram(this.a);Da(b,a);c.vertexAttribPointer(0,1,c.FLOAT,!1,0,0);c.bindFramebuffer(c.FRAMEBUFFER,b.H);c.bindTexture(c.TEXTURE_2D,e);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,e,0);c.bindTexture(c.TEXTURE_2D,null);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,d);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.uniform1i(c.getUniformLocation(this.a,"sampler"),0);c.disable(c.DEPTH_TEST);c.viewport(0,0,2048,2048);c.drawArrays(c.POINTS,0,b.h);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0);c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindBuffer(c.ARRAY_BUFFER,null);b.i[0]=e;b.m[0]=d};function za(a,b,c){this.a=b;this.b=c;c=a.g;var d=this.a,e=T(d);this.O=V(d,0===e.length?"y":e[e.length-1]);this.ha=l["Common.glsl"];this.ia=Ra(b);this.D=l["Textures.glsl"];void 0===a.OES_texture_float&&(a.OES_texture_float=a.g.getExtension("OES_texture_float"),a.OES_texture_float||alert("Extension OES_texture_float not supported on your device"));b=a.g;for(var d=[],e=[],f=0;5>f;f++)d[f]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,d[f]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,2048,2048,0,b.RGBA,b.FLOAT,null),e[f]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,e[f]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,2048,2048,0,b.RGBA,b.FLOAT,null);b.bindTexture(b.TEXTURE_2D,null);this.i=d;this.m=e;this.f=new eb(a,this);this.f.l(a,this,c);this.M=new rb(a,this);this.L=new qb(a,
this);for(b=0;b<this.b;b++)this.M.l(a,this,c),this.L.l(a,this,c);this.c=new Ba(a,this);this.c.l(a,this,c);b=M("Surface");b[0]=[this.D,b[0]].join("\n");b[1]=Ca(this,b[1]);this.U=N(a,b);a=c.canvas;c.viewport(0,0,a.width,a.height)}k=za.prototype;k.ha="";k.ia="";k.ba=function(a,b){return Fa(this.a,a,void 0===b?!1:b)};k.ca=function(a,b){b=void 0===b?"surface.bin":b;a=J(a,this.i[0],4*this.h);a=URL.createObjectURL(new Blob([a],{type:"application/octet-binary"}));K(b,a)};
k.da=function(a,b,c){Ga(this.a,a,void 0===b?"sheet":b,void 0===c?!0:c)};k.ea=function(a,b,c){b=void 0===b?"surface":b;c=void 0===c?!0:c;var d=J(a,this.i[0],4*this.h);Ha(a,d,b,c)};function Da(a,b){b=b.g;for(var c=[],d=0;d<a.h;d++)c[d]=d;b.bindBuffer(b.ARRAY_BUFFER,a.T);b.bufferData(b.ARRAY_BUFFER,new Float32Array(c),b.STATIC_DRAW)}k.H=null;k.T=null;k.h=0;k.U=null;
k.l=function(a,b,c){b.useProgram(this.U);Ia(a);Ja(a,"m",Ka(c.j));La(a,c);Ma(a,c);Na(a);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,this.i[0]);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.uniform1i(b.getUniformLocation(this.U,"sampler"),0);Da(this,a);b.vertexAttribPointer(0,1,b.FLOAT,!1,
0,0);b.enable(b.DEPTH_TEST);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.drawArrays(b.TRIANGLES,0,this.h);Na(a,!1)};k.O=0;k.i=[];k.m=[];k.D="";function Ca(a,b){return[a.ia,a.ha,b].join("\n")};function x(a,b){this.b=a;this.a=b}x.prototype.b=null;x.prototype.a=null;
function ib(a){function b(a,d){if(0===d.length)return a;if(1===d.length)return a.push(d[0]),a;for(var e=d.pop(),f=e.b,e=e.a,g=[],h=0,n=d.length;h<n;h++){var m;a:{m=e;var q=d[h].a,p=void 0;for(p in m.value)if(!q.value.hasOwnProperty(p)||m.value[p]!==q.value[p]){m=!1;break a}for(p in q.value)if(!m.value.hasOwnProperty(p)||m.value[p]!==q.value[p]){m=!1;break a}m=!0}m?f=O(f,d[h].b):g.push(d[h])}a.push(new x(f,e));return b(a,g)}return b([],a)};function sb(){this.a=[["\\d*\\.\\d*","number"],["\\d+","number"],["i","imaginary"],["[a-hj-z]","variable"],["[\\+\\*\\^-]","operator"],["[\\(\\)]","parenthesis"]]}function ma(a){for(var b=(new sb).a,c="(?:",d=0,e=b.length;d<e;d++)c+=(0<d?"|(":"(")+b[d][0]+")";c=new RegExp(c+")","g");for(d=[];null!==(e=c.exec(a));){var f=e[0];d.push({type:b[e.slice(1).indexOf(f)][1],value:f})}return d};
})();//# sourceMappingURL=ComplexCurves.js.map

