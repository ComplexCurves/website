/**
 * @license
 *
 * Complex Curves
 *
 * Copyright 2016 Stefan Kranich
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(function(){
'use strict';var k,l={"Assembly.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D samplers[1 + N/2];\nuniform float sheet;\nvarying float which;\nvarying vec2 texCoord[3];\n\nvoid readTex (out vec2 pos[3], out float delta[3], out vec2 values[3*N]) {\nvec4 s;\nfor (int i = 0; i < 3; i++) {\ns = texture2D (samplers[0], texCoord[i]);\npos[i] = s.xy;\ndelta[i] = s.z;\nfor (int j = 1; j < N/2; j++) {\ns = texture2D (samplers[j], texCoord[i]);\nvalues[i*N+2*j-2] = s.xy;\nvalues[i*N+2*j-1] = s.zw;\n}\n}\n}\n\nbool valid (in vec2 position[3], in float delta[3]) {\nreturn distance (position[0], position[1]) < min (delta[0], delta[1])\n&& distance (position[1], position[2]) < min (delta[1], delta[2])\n&& distance (position[2], position[0]) < min (delta[2], delta[0]);\n}\n\nvoid main(void) {\nint isheet = int(sheet);\nif (isheet < sheets) {\nvec2 pos[3];\nfloat delta[3];\nvec2 values[3*N];\nreadTex (pos, delta, values);\nif (valid (pos, delta)) {\nfor (int s = 0; s < sheets; s++) {\nif (s == isheet) {\nvec2 valueA = values[s];\nint iwhich = int(which);\nfor (int w = 0; w < 3; w++) {\nif (w == iwhich) {\nvec2 valueWhich = values[w*N];\nfloat dist, minDist = distance (valueA, valueWhich);\nfor (int i = 1; i < sheets; i++) {\ndist = distance (valueA, values[w*N+i]);\nif (dist < minDist)\n{\nvalueWhich = values[w*N+i];\nminDist = dist;\n}\n}\ngl_FragColor = vec4(pos[w], valueWhich);\n}\n}\n}\n}\nreturn;\n}\n}\ngl_FragColor = vec4(-10.0, -10.0, -10.0, 1.0);\n}\n",
"Assembly.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute float index;\nuniform float numIndices;\nuniform float sheet;\nvarying vec2 texCoord[3];\nvarying float which;\n\nvoid main (void) {\ngl_Position = indexedPosition (sheet * numIndices + index);\nwhich = mod (index, 3.0);\ntexCoord[0] = uvPosition (index - which);\ntexCoord[1] = uvPosition (index - which + 1.0);\ntexCoord[2] = uvPosition (index - which + 2.0);\n}\n","CachedSurface.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform bool clipping;\nvarying vec4 vPos;\nvarying vec2 vValue;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nif (clipping && vPos.y < 0.0)\ndiscard;\nfloat PI = acos (-1.0);\nfloat angle = atan (vValue.y, vValue.x);\nfloat blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\nfloat blackm = sawfct (log (length (vValue)), PI / 12.0, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb (angle), gl_FragCoord.z);\n}\n",
"CachedSurface.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec4 position;\nuniform mat4 m, v, p;\nvarying vec4 vPos;\nvarying vec2 vValue;\nvoid main (void)\n{\nvPos = vec4 (position.xyz, 1.0);\nvValue = position.zw;\ngl_Position = p * v * m * vPos;\n}\n","Common.glsl":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#define EPS 5e-3\n\n/* complex division */\nvec2 cd (in vec2 a, in vec2 b) {\n\treturn vec2 (a.x * b.x + a.y * b.y, a.y * b.x - a.x * b.y) / dot (b, b);\n}\n\nvec2 cinv (in vec2 z) {\nreturn vec2(z.x, -z.y) / dot(z, z);\n}\n\n/* complex square root */\nvec2 csqrt (in vec2 z)\n{\nfloat r = sqrt (length (z));\nfloat phi = 0.5 * atan (z.y, z.x);\nreturn r * vec2 (cos (phi), sin (phi));\n}\n\nvec2 horner (in int n, in vec2 cs[N+1], in vec2 x) {\nvec2 p;\nfor (int i = N - 1; i >= 0; i--)\nif (i >= n)\np = cs[i];\nelse if (i < n)\np = cs[i] + cm(p, x);\nreturn p;\n}\n\nvoid weierstrass (in vec2 cs[N+1], out vec2 roots2[N]) {\n\t/* polynomial must be monic! */\nvec2 csn = cs[sheets];\nif (csn != vec2 (1.0, 0.0))\nfor (int i = 0; i <= sheets; i++)\ncs[i] = cd (cs[i], csn);\n\nfloat maxabs = length (cs[0]);\nfor (int i = 1; i < N; i++)\nif (i < sheets)\nmaxabs = max (maxabs, length (cs[i]));\nfloat upperBound = 1.0 + maxabs; /// length (cs[n]);\nfloat phi = 2.0 * acos (-1.0) / float (sheets + 1);\nfloat d = upperBound / float (sheets);\nd = clamp (d, 1.0, 10.0);\n\tfor (int i = 0; i < sheets; i++)\nroots2[i] = float (i) * d * vec2 (cos (float (i) * phi), sin (float (i) * phi));\n\n\tconst int maxiter = 50;\n\tbool changing;\n\tfor (int iter = 0; iter < maxiter; iter++)\n\t{\n\t\tchanging = false;\n\t\tfor (int i = 0; i < sheets; i++)\n{\nvec2 result = vec2 (1.0, 0.0);\nfor (int j = 0; j < sheets; j++)\nif (j != i)\nresult = cm (result, roots2[i] - roots2[j]);\nvec2 update = cd (horner (sheets, cs, roots2[i]), result);\n///* safe-guard against large update */\n//if (sheets > 1 && length (update) > 10)\n//\tupdate /= length (update);\nif (length (update) > 1e-2)\nchanging = true;\nroots2[i] -= update;\n}\nif (!changing)\nbreak;\n\t}\n}\n\nvoid quadratic_roots (in vec2 cs[N+1], out vec2 qroots[2]) {\nif (cs[0] == vec2 (0.0, 0.0)) {\nqroots[0] = vec2 (0.0, 0.0);\nqroots[1] = -cd (cs[1], cs[2]);\n}\nelse\n{\nvec2 r = csqrt (cm (cs[1], cs[1]) - 4.0 * cm (cs[2], cs[0]));\nif (cs[1].x >= 0.0)\nr = -r;\nqroots[0] = cd (r - cs[1], 2.0 * cs[2]);\nqroots[1] = cd (2.0 * cs[0], r - cs[1]);\n}\n}\n\nvoid roots (in int n, in vec2 cs[N+1], out vec2 roots[N])\n{\nif (n == 1) {\nroots[0] = -cd (cs[0], cs[1]);\nreturn;\n}\nif (n == 2) {\nvec2 qroots[2];\nquadratic_roots (cs, qroots);\nroots[0] = qroots[0];\nroots[1] = qroots[1];\nreturn;\n}\nweierstrass (cs, roots);\n/* selection sort by real part */\n/*\nfor(int i = 0; i < n - 1; i++)\n{\nint jmin = i;\nfor (int j = i + 1; j < n; j++)\nif (roots[j].x < roots[jmin].x)\njmin = j;\nvec2 z = roots[i];\nroots[i] = roots[jmin];\nroots[jmin] = z;\n}\n*/\n}\n\nvoid f (in vec2 x, out vec2 cs[N+1]);\nvec2 fx (in vec2 x, in vec2 y);\nvec2 fy (in vec2 x, in vec2 y);\nfloat rho (in vec2 x);\nfloat M (in vec2 x, in float rho);\n\nfloat epsilon (in vec2 ys[N]) {\nfloat d = distance (ys[0], ys[1]);\nfor (int j = 0; j < sheets; j++) {\nfor (int k = 0; k < sheets; k++) {\nif (k > j)\nd = min (d, distance (ys[j], ys[k]));\n}\n}\nreturn d / 2.0;\n}\n\nfloat Y (in vec2 x, in vec2 ys[N]) {\nfloat y = length (cd (fx (x, ys[0]), fy (x, ys[0])));\nfor (int j = 0; j < sheets; j++)\ny = max (y, length (cd (fx (x, ys[j]), fy (x, ys[j]))));\nreturn y;\n}\n\nfloat Delta (in vec2 x, in vec2 ys[N]) {\nfloat eps = epsilon (ys);\nfloat r = rho (x);\nfloat m = M (x, r);\nfloat y = Y (x, ys);\nreturn r * (sqrt (pow (r * y - eps, 2.0) + 4.0 * eps * m) -\n(r * y + eps)) / (2.0 * (m - r * y));\n}\n",
"DomainColouring.frag":"\nuniform int sheet;\nvarying vec2 vPosition;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nvec2 cs[N+1];\nvec2 ys[N];\nvec2 value;\nf (vPosition, cs);\nroots (sheets, cs, ys);\nint smaller;\nfor (int i = 0; i < sheets; i++)\n{\nsmaller = 0;\nfor (int j = 0; j < sheets; j++)\nif (ys[j].x < ys[i].x)\nsmaller++;\nif (smaller == sheet - 1)\nvalue = ys[i];\n}\n\nfloat PI = acos (-1.0);\nfloat angle = atan (value.y, value.x);\nfloat blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\nfloat blackm = sawfct (log (length (value)), PI / 12.0, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb(angle), 1.0);\n}\n",
"DomainColouring.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec2 position;\nvarying vec2 vPosition;\nvoid main () {\ngl_Position = vec4 (position, 0.0, 1.0);\nvPosition = 5.0 * position;\n}\n","Export.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nvarying vec2 vValue;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nfloat PI = acos (-1.0);\nfloat angle = atan (vValue.y, vValue.x);\nfloat blackp = sawfct (angle / (2.0 * PI), 0.05, 0.7, 1.0);\nfloat blackm = sawfct (log (length (vValue)), 0.1 * PI, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb(angle), 1.0);\n}\n",
"Export.vert":"\nuniform float maxValue;\nuniform float minValue;\nattribute vec2 vPosition;\nvarying vec2 vValue;\n\nvoid main()\n{\ngl_Position = vec4(vPosition, 0.0, 1.0);\nvValue = 0.5 * (maxValue - minValue) * (vPosition + vec2 (1.0, 1.0))\n+ vec2 (minValue, minValue);\n}\n","FXAA.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D u_tex;\nuniform float width;\nuniform float height;\n\n#define FXAA_REDUCE_MIN (1.0/ 128.0)\n#define FXAA_REDUCE_MUL (1.0 / 8.0)\n#define FXAA_SPAN_MAX 8.0\n// from https://github.com/mitsuhiko/webgl-meincraft/blob/master/assets/shaders/fxaa.glsl\nvec4 applyFXAA(in vec2 fragCoord, in sampler2D tex)\n{\nvec4 color;\nvec2 inverseVP = vec2(1.0 / width, 1.0 / height);\nvec3 rgbNW = texture2D(tex, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;\nvec3 rgbNE = texture2D(tex, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;\nvec3 rgbSW = texture2D(tex, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;\nvec3 rgbSE = texture2D(tex, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;\nvec3 rgbM = texture2D(tex, fragCoord * inverseVP).xyz;\nvec3 luma = vec3(0.299, 0.587, 0.114);\nfloat lumaNW = dot(rgbNW, luma);\nfloat lumaNE = dot(rgbNE, luma);\nfloat lumaSW = dot(rgbSW, luma);\nfloat lumaSE = dot(rgbSE, luma);\nfloat lumaM = dot(rgbM, luma);\nfloat lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\nfloat lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\nvec2 dir;\ndir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\ndir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));\nfloat dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n(0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\nfloat rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\ndir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\nmax(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\ndir * rcpDirMin)) * inverseVP;\nvec3 rgbA = 0.5 * (\ntexture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\ntexture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\nvec3 rgbB = rgbA * 0.5 + 0.25 * (\ntexture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\ntexture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\nfloat lumaB = dot(rgbB, luma);\nif ((lumaB < lumaMin) || (lumaB > lumaMax))\ncolor = vec4(rgbA, 1.0);\nelse\ncolor = vec4(rgbB, 1.0);\nreturn color;\n}\n\nvoid main (void)\n{\ngl_FragColor = applyFXAA(gl_FragCoord.xy, u_tex);\n}\n",
"FXAA.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec2 vPosition;\nvoid main()\n{\ngl_Position = vec4(vPosition, 0.0, 1.0);\n}\n","Initial.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform int computedRoots;\nvarying vec2 texCoord;\nvarying vec2 vPosition;\nvoid main(void) {\nvec2 position = clamp (vPosition, -5.0, 5.0);\nvec2 values[N];\nvec2 cs[N+1];\nf (position, cs);\nroots (sheets, cs, values);\n\nif (computedRoots < sheets) {\nfor (int i = 0; i < N; i += 2) {\nif (i == computedRoots)\nif (computedRoots + 1 < sheets)\ngl_FragColor = vec4(values[i], values[i + 1]);\nelse\ngl_FragColor = vec4(values[i], vec2 (0.0, 0.0));\n}\n} else {\nfloat delta = Delta (position, values);\ngl_FragColor = vec4 (position, delta, 1.0);\n}\n}\n",
"Initial.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute float index;\nattribute vec2 position;\nvarying vec2 texCoord;\nvarying vec2 vPosition;\nvoid main (void) {\nvPosition = position;\ngl_Position = indexedPosition (index);\ntexCoord = uvPosition (index);\n}\n","Subdivision.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform int computedRoots;\nuniform sampler2D oldSamplers[1 + N/2];\nvarying vec3 barycentric;\nvarying vec2 texCoord[3];\nvarying vec2 texCoordOut;\n\nvoid main(void) {\nif (barycentric == vec3 (1.0, 0.0, 0.0)) {\nif (computedRoots >= sheets) {\ngl_FragColor = texture2D (oldSamplers[0], texCoord[0]);\n} else {\nint i = computedRoots / 2 + 1;\nfor (int j = 1; j < 1 + N/2; j++)\nif (j == i)\ngl_FragColor = texture2D (oldSamplers[j], texCoord[0]);\n}\n} else if (barycentric == vec3 (0.0, 1.0, 0.0)) {\nif (computedRoots >= sheets) {\ngl_FragColor = texture2D (oldSamplers[0], texCoord[1]);\n} else {\nint i = computedRoots / 2 + 1;\nfor (int j = 1; j < 1 + N/2; j++)\nif (j == i)\ngl_FragColor = texture2D (oldSamplers[j], texCoord[1]);\n}\n} else if (barycentric == vec3 (0.0, 0.0, 1.0)) {\nif (computedRoots >= sheets) {\ngl_FragColor = texture2D (oldSamplers[0], texCoord[2]);\n} else {\nint i = computedRoots / 2 + 1;\nfor (int j = 1; j < 1 + N/2; j++)\nif (j == i)\ngl_FragColor = texture2D (oldSamplers[j], texCoord[2]);\n}\n} else {\nvec2 values[N];\nvec2 position = barycentric.x * texture2D (oldSamplers[0], texCoord[0]).xy\n+ barycentric.y * texture2D (oldSamplers[0], texCoord[1]).xy\n+ barycentric.z * texture2D (oldSamplers[0], texCoord[2]).xy;\nvec2 cs[N+1];\nf (position, cs);\nroots (sheets, cs, values);\n\nif (computedRoots < sheets) {\nfor (int i = 0; i < N; i += 2) {\nif (i == computedRoots)\nif (computedRoots + 1 < sheets)\ngl_FragColor = vec4(values[i], values[i + 1]);\nelse\ngl_FragColor = vec4(values[i], vec2 (0.0, 0.0));\n}\n} else {\nfloat delta = Delta (position, values);\ngl_FragColor = vec4 (position, delta, 1.0);\n}\n}\n}\n",
"Subdivision.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec4 indexBarycentric;\nattribute float indexOffsetIn;\nattribute float indexOffsetOut;\nvarying vec3 barycentric;\nvarying vec2 texCoord[3];\nvarying vec2 texCoordOut;\n\nvoid main (void) {\nfloat indexOut = indexBarycentric.x + indexOffsetOut;\ngl_Position = indexedPosition (indexOut);\nbarycentric = indexBarycentric.yzw;\ntexCoord[0] = uvPosition (indexOffsetIn);\ntexCoord[1] = uvPosition (indexOffsetIn + 1.0);\ntexCoord[2] = uvPosition (indexOffsetIn + 2.0);\ntexCoordOut = uvPosition (indexOut);\n}\n",
"SubdivisionPre.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D sampler;\nvarying vec2 texCoord[2];\n\nbool validOutgoingEdge () {\nvec3 next = texture2D (sampler, texCoord[1]).xyz;\nreturn distance (gl_FragColor.xy, next.xy) < min (gl_FragColor.z, next.z);\n}\n\nvoid main(void) {\ngl_FragColor = texture2D (sampler, texCoord[0]);\nif (gl_FragColor.w == 1.0 && validOutgoingEdge ())\ngl_FragColor.w = 0.0;\n}\n","SubdivisionPre.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute float index;\nvarying vec2 texCoord[2];\n\nvoid main (void) {\ngl_Position = indexedPosition (index);\nfloat j = 1.0;\nif (mod (index, 3.0) > 1.0)\nj = -2.0;\ntexCoord[0] = uvPosition (index);\ntexCoord[1] = uvPosition (index + j);\n}\n",
"Surface.frag":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform bool clipping;\nvarying vec4 vPos;\nvarying vec2 v_value;\nvec3 hue_to_rgb (in float hue)\n{\nhue = mod (degrees (hue), 360.0) / 60.0;\nint h = int (floor (hue));\nfloat f = fract (hue);\nif (h == 0)\nreturn vec3 (1.0, f, 0.0);\nelse if (h == 1)\nreturn vec3 (1.0 - f, 1.0, 0.0);\nelse if (h == 2)\nreturn vec3 (0.0, 1.0, f);\nelse if (h == 3)\nreturn vec3 (0.0, 1.0 - f, 1.0);\nelse if (h == 4)\nreturn vec3 (f, 0.0, 1.0);\nelse if (h == 5)\nreturn vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\nreturn a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\nif (clipping && vPos.y < 0.0)\ndiscard;\nfloat PI = acos (-1.0);\nfloat angle = atan (v_value.y, v_value.x);\nfloat blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\nfloat blackm = sawfct (log (length (v_value)), PI / 12.0, 0.7, 1.0);\nfloat black = blackp * blackm;\ngl_FragColor = vec4 (black * hue_to_rgb (angle), gl_FragCoord.z);\n}\n",
"Surface.vert":"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform mat4 m;\nuniform mat4 v;\nuniform mat4 p;\nuniform sampler2D sampler;\nattribute float index;\nvarying vec4 vPos;\nvarying vec2 v_value;\nvoid main (void)\n{\nvec4 posValue = texture2D (sampler, uvPosition (index));\nvPos = vec4 (posValue.xyz, 1.0);\nv_value = posValue.zw;\ngl_Position = p * v * m * vPos;\n}\n","Textures.glsl":"\n#define W 2048.0\n#define H 2048.0\nvec2 uvPosition (in float i) {\nconst float h = 2048.0;\nreturn vec2 (mod (i, W) / W + 0.5 / W, floor (i / W) / H + 0.5 / H);\n}\n\nvec4 indexedPosition (in float i) {\nfloat x = mod (i, W) / W;\nfloat y = floor (i / W) / H;\nreturn vec4 (x * 2.0 - 1.0 + 1.0 / W, y * 2.0 - 1.0 + 1.0 / H, 0.0, 1.0);\n}\n"};function u(){}
u.a=function(a){var c=a.type,b=a.value;if("infix"===c){c=u.a(a.first);a=u.a(a.second);if("+"===b)return aa(c,a);if("-"===b)return aa(c,ba(a));if("*"===b)return ca(c,a);if("^"===b){if(da(a)&&(b=ea(a),0<=b.a&&!b.b))return fa(c,b.a);console.error("Illegal exponent")}else console.error("Infix operator '"+b+"' not implemented")}else if("prefix"===c){c=u.a(a.first);if("+"===b)return c;if("-"===b)return ba(c);console.error("Prefix operator '"+b+"' not implemented")}else{if("number"===c)return new v([new x(z(parseFloat(b)),new A({}))]);
if("variable"===c)return c={},c[b]=1,new v([new x(ga,new A(c))]);if("imaginary"===c)return new v([new x(new B(0,1),new A({}))])}return null};
u.b=function(a){function c(a,b){function c(a,b){return{type:"infix",value:b[0].value,first:a,second:b[1]}}return b===[]?a:b.reduce(c,a)}function b(a){a=C(ha(ia(m,d),d),ja(C(m,d)))(a);return null===a?null:c(a[0],a[1])}function d(a){a=C(e,ja(C(q,e)))(a);return null===a?null:c(a[0],a[1])}function e(a){var c=ha(la(b),g,h,n)(a);return null===c?null:(a=f(a))?{type:"infix",value:"^",first:c,second:a}:c}function f(a){var b=C(p,g)(a);return null===b?null:(a=f(a))?{type:"infix",value:"^",first:b[1],second:a}:
b[1]}a=ma(a);var g=na("number"),h=na("imaginary"),n=na("variable"),m=ha(E("+"),E("-")),q=E("*"),p=E("^");return function(a){return(a=C(b,oa)(a))?a[0]:null}(a)};var F=5/12*Math.PI,G=Math.PI/6;function I(a,c,b,d){c=void 0===c?F:c;b=void 0===b?G:b;this.c=a;c=J(c,b);b=new pa;b.B=void 0===d?!1:d;b.j=b.R=b.s=c;this.a=b;this.b=new qa(a);ra(this)}k=I.prototype;k.oa=function(a){var c=this.b;return c.w.ba(c,void 0===a?!1:a)};k.pa=function(a){var c=this.b;c.w.ca(c,void 0===a?"surface.bin":a)};k.qa=function(a,c){var b=this.b;b.w.da(b,void 0===a?"sheet":a,void 0===c?!0:c)};
k.Ca=function(a,c){a=void 0===a?"surface.png":a;c=void 0===c?!1:c;var b=this,d=this.b;sa(d,function(){K(b)},c);c=L(d,c?d.A:d.v);M(a,ta(c))};k.ra=function(a,c){var b=this.b;b.w.ea(b,void 0===a?"surface":a,void 0===c?!0:c)};
function ra(a){var c=a.c,b=a.a;a.f=function(c){c.preventDefault();b.o||(ua(b,[c.clientX,c.clientY]),K(a))};a.N=function(a){a.preventDefault();va(b,a.clientX,a.clientY)};a.O=function(a){a.preventDefault();b.P=[0,0];b.C=!1};a.ma=function(c){c.preventDefault();c=c.touches[0];ua(b,[c.clientX,c.clientY]);K(a)};a.la=function(a){a.preventDefault();a=a.touches[0];va(b,a.clientX,a.clientY)};a.ka=function(a){a.preventDefault();b.P=[0,0];b.C=!1};a.na=function(c){c.preventDefault();b.F=0<c.deltaY?Math.min(4,
b.F+.1):Math.max(.5,b.F-.1);K(a)};c.addEventListener("mousedown",a.f);c.addEventListener("mousemove",a.N);c.addEventListener("mouseup",a.O);c.addEventListener("touchstart",a.ma);c.addEventListener("touchmove",a.la);c.addEventListener("touchend",a.ka);c.addEventListener("wheel",a.na)}function K(a){var c=a.a;wa(a.b,c);if(c.o||c.C||1E-6<xa(c.j,c.s).abs())ya(c),requestAnimationFrame(function(){K(a)})}k.Da=function(){this.u(Math.PI/2,Math.PI)};k.Ea=function(){this.u(Math.PI,0)};
k.Fa=function(){this.u(F,G)};k.Ga=function(){this.u(Math.PI/2,0)};k.u=function(a,c){this.a.o=!1;this.a.s=this.a.R=this.a.j;this.a.s=J(a,c);K(this)};k.Ha=function(){this.u(Math.PI/2,-Math.PI/2)};k.Ia=function(){this.u(Math.PI/2,Math.PI/2)};k.Ja=function(){this.u(0,0)};k.sa=function(a){this.b.M=a;K(this)};k.ta=function(a){this.a.o=a;K(this)};k.ua=function(a){this.b.L=a;K(this)};k.Ka=function(a,c){a=J(a,c);this.a.o=!1;this.a.C=!1;this.a.j=this.a.s=a;K(this)};k.va=function(a){this.a.B=a;K(this)};
k.wa=function(a){this.b.S=a;K(this)};k.La=function(a){this.a.F=a||1;K(this)};k.xa=function(){var a=this.b;a.M=!a.M;K(this)};k.ya=function(){var a=this.a;a.o=!a.o;K(this)};k.za=function(){var a=this.b;a.L=!a.L;K(this)};k.Aa=function(){var a=this.a;a.B=!a.B;K(this)};k.Ba=function(){var a=this.b;a.S=!a.S;K(this)};
k.Ma=function(){var a=this.c;a.removeEventListener("mousedown",this.f);a.removeEventListener("mousemove",this.N);a.removeEventListener("mouseup",this.O);a.removeEventListener("touchstart",this.ma);a.removeEventListener("touchmove",this.la);a.removeEventListener("touchend",this.ka);a.removeEventListener("wheel",this.na)};window.ComplexCurves=I;I.fromEquation=function(a,c,b,d,e,f){d=void 0===d?F:d;e=void 0===e?G:e;f=void 0===f?!1:f;c=u.a(u.b(c));d=void 0===d?F:d;e=void 0===e?G:e;a=new I(a,d,e,void 0===f?!1:f);f=a.b;f.w=new za(f,c,b);K(a);return a};I.fromFile=function(a,c,b,d,e,f,g){d=void 0===d?F:d;e=void 0===e?G:e;f=void 0===f?!1:f;g=g?g:function(){};b=u.a(u.b(void 0===b?"":b));var h=new I(a,d,e,f);a=h.b;a.w=new Aa(a,c,b,function(){K(h);g()});return h};I.prototype.domainColouring=I.prototype.oa;
I.prototype.exportBinary=I.prototype.pa;I.prototype.exportDomainColouring=I.prototype.qa;I.prototype.exportScreenshot=I.prototype.Ca;I.prototype.exportSurface=I.prototype.ra;I.prototype.rotateBack=I.prototype.Da;I.prototype.rotateBottom=I.prototype.Ea;I.prototype.rotateDefault=I.prototype.Fa;I.prototype.rotateFront=I.prototype.Ga;I.prototype.rotateLatLong=I.prototype.u;I.prototype.rotateLeft=I.prototype.Ha;I.prototype.rotateRight=I.prototype.Ia;I.prototype.rotateTop=I.prototype.Ja;
I.prototype.setAntialiasing=I.prototype.sa;I.prototype.setAutorotate=I.prototype.ta;I.prototype.setClipping=I.prototype.ua;I.prototype.setLatLong=I.prototype.Ka;I.prototype.setOrtho=I.prototype.va;I.prototype.setTransparency=I.prototype.wa;I.prototype.setZoom=I.prototype.La;I.prototype.toggleAntialiasing=I.prototype.xa;I.prototype.toggleAutorotate=I.prototype.ya;I.prototype.toggleClipping=I.prototype.za;I.prototype.toggleOrtho=I.prototype.Aa;I.prototype.toggleTransparency=I.prototype.Ba;
I.prototype.unregisterEventHandlers=I.prototype.Ma;window.PolynomialParser=u;u.parse=u.b;function Ba(a,c){var b=N("Assembly");b[0]=[c.D,b[0]].join("\n");b[1]=Ca(c,b[1]);this.a=O(a,b)}Ba.prototype.a=null;
Ba.prototype.l=function(a,c,b){var d=c.h,e=c.m[0];b.useProgram(this.a);var f=c.i;b.uniform1f(b.getUniformLocation(this.a,"numIndices"),f);Da(c,a);b.vertexAttribPointer(0,1,b.FLOAT,!1,0,0);b.bindFramebuffer(b.FRAMEBUFFER,c.H);b.bindTexture(b.TEXTURE_2D,e);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);b.bindTexture(b.TEXTURE_2D,null);for(var e=[],g=0,h=d.length;g<h;g++)b.activeTexture(b.TEXTURE0+g),b.bindTexture(b.TEXTURE_2D,d[g]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,
b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),e[g]=g;b.uniform1iv(b.getUniformLocation(this.a,"samplers"),e);b.disable(b.DEPTH_TEST);b.viewport(0,0,2048,2048);d=b.getUniformLocation(this.a,"sheet");e=0;for(g=c.J;e<g;e++)b.uniform1f(d,e),b.drawArrays(b.POINTS,0,f);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0);b.bindFramebuffer(b.FRAMEBUFFER,
null);b=c.h;c.h=c.m;c.m=b;c.i*=c.J;Da(c,a)};function Aa(a,c,b,d){d=d?d:function(){};var e=this;e.G=void 0===b?null:b;Ea(e,c,function(){var b=e.W,c=a.g;e.ga=b.byteLength/16;c.enableVertexAttribArray(0);e.X=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,e.X);c.bufferData(c.ARRAY_BUFFER,new Float32Array(b),c.STATIC_DRAW);e.T=O(a,N("CachedSurface"));d()})}k=Aa.prototype;k.ba=function(a,c){return this.G?Fa(this.G,a,void 0===c?!1:c):[]};k.ca=function(a,c){M(void 0===c?"surface.bin":c,this.fa)};
k.da=function(a,c,b){this.G&&Ga(this.G,a,void 0===c?"sheet":c,void 0===b?!0:b)};k.ea=function(a,c,b){c=void 0===c?"surface":c;b=void 0===b?!0:b;Ha(a,new Float32Array(this.W),c,b)};k.fa="";function Ea(a,c,b){a.fa=c;var d=new XMLHttpRequest;d.open("GET",c,!0);d.responseType="arraybuffer";d.onload=function(){a.W=d.response;b()};d.send()}k.G=null;k.W=null;k.X=null;k.T=null;
k.l=function(a,c,b){this.T&&(c.useProgram(this.T),Ia(a),Ja(a,"m",Ka(b.j)),La(a,b),Ma(a,b),Na(a),c.bindBuffer(c.ARRAY_BUFFER,this.X),c.vertexAttribPointer(0,4,c.FLOAT,!1,0,0),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),c.drawArrays(c.TRIANGLES,0,this.ga),Na(a,!1))};k.ga=0;function B(a,c){this.a=a;this.b=c}B.prototype.abs=function(){return Math.sqrt(this.a*this.a+this.b*this.b)};function P(a,c){return new B(a.a+c.a,a.b+c.b)}function Q(a,c){var b=c.a*c.a+c.b*c.b;return new B((a.a*c.a+a.b*c.b)/b,(a.b*c.a-a.a*c.b)/b)}B.prototype.b=0;var Oa=new B(Infinity,Infinity);function R(a,c){return new B(a.a*c.a-a.b*c.b,a.a*c.b+a.b*c.a)}function Pa(a){return new B(-a.a,-a.b)}var ga=new B(1,0);B.prototype.a=0;function z(a){return new B(a,0)}
function Qa(a){if(!a.a&&!a.b)return S();var c=a.abs();return new B(Math.sqrt(.5*(c+a.a)),(Math.sign(a.b)||1)*Math.sqrt(.5*(c-a.a)))}function T(a,c){return new B(a.a-c.a,a.b-c.b)}function S(){return new B(0,0)};function Fa(a,c,b){function d(a){e.useProgram(h);e.bindBuffer(e.ARRAY_BUFFER,c.I);e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0);n=e.getUniformLocation(h,"sheet");e.uniform1i(n,a);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);e.drawArrays(e.TRIANGLES,0,3)}b=void 0===b?!1:b;var e=c.g,f=N("DomainColouring"),g=Ra(a);f[1]=[g,l["Common.glsl"],f[1]].join("\n");var h=O(c,f),n,f=U(a);a=V(a,f.length?f[f.length-1]:"y");for(var f=[],m=1;m<=a;m++)sa(c,d.bind(null,m),b),g=L(c,b?c.A:c.v),f[m-1]=ta(g);return f}
function M(a,c){var b=document.createElement("a");b.href=c;b.download=a;b.style.display="none";document.body.appendChild(b);b.click();document.body.removeChild(b)}function Ga(a,c,b,d){b=void 0===b?"sheet":b;a=Fa(a,c,void 0===d?!0:d);c=0;for(d=a.length;c<d;c++)M(b+(c+1)+".png",a[c])}
function Ha(a,c,b,d){b=void 0===b?"surface":b;d=void 0===d?!0:d;var e,f,g,h,n,m,q,p=-Infinity,r=Infinity;m=c.byteLength/c.BYTES_PER_ELEMENT/4;var y=[];for(f=0;f<4*m;f+=4)e=c[f],g=c[f+1],h=c[f+2],n=c[f+3],y.push([e,g,h]),r=Math.min(r,Math.min(h,n)),p=Math.max(p,Math.max(h,n));e=p-r;var w=[];for(f=2;f<4*m;f+=4)g=(c[f]-r)/e,h=(c[f+1]-r)/e,w.push([g,h]);c=[];for(f=1;f<=m;f+=3)e=f+1,g=f+2,c.push([f,e,g]);q=y.map(function(a,b){var c=w[b];return y.findIndex(function(b,d){d=w[d];return a[0]===b[0]&&a[1]===
b[1]&&a[2]===b[2]&&c[0]===d[0]&&c[1]===d[1]})});var D=Array.from(new Set(q)),y=D.map(function(a){return y[a]}),w=D.map(function(a){return w[a]});c=c.map(function(a){return a.map(function(a){return D.findIndex(function(b){return b===q[a-1]})+1})});f=y.map(function(a){return"v "+a[0]+" "+a[1]+" "+a[2]});m=w.map(function(a){return"vt "+a[0]+" "+a[1]});c=c.map(function(a){var b=a[0],c=a[1];a=a[2];return"f "+b+"/"+b+" "+c+"/"+c+" "+a+"/"+a});e=["mtllib "+b+".mtl","usemtl surface","s 1"];e=e.concat(f,m,
c);e="data:text/plain,"+encodeURIComponent(e.join("\n"));M(b+".obj",e);var t=a.g,H=O(a,N("Export")),ka;sa(a,function(){t.useProgram(H);t.bindBuffer(t.ARRAY_BUFFER,a.I);t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0);ka=t.getUniformLocation(H,"minValue");t.uniform1f(ka,r);ka=t.getUniformLocation(H,"maxValue");t.uniform1f(ka,p);t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);t.drawArrays(t.TRIANGLES,0,3)},d);d=L(a,d?a.A:a.v);M(b+".png",ta(d));d=["newmtl surface","map_Kd "+b+".png","illum 0"];d="data:text/plain,"+
encodeURIComponent(d.join("\n"));M(b+".mtl",d)}function ta(a){var c=Math.sqrt(a.length/4),b=document.createElement("canvas");b.width=c;b.height=c;var d=b.getContext("2d"),e=d.createImageData(b.width,b.height);e.data.set(a);d.putImageData(e,0,0);a=document.createElement("canvas");a.width=c;a.height=c;c=a.getContext("2d");c.translate(0,a.height-1);c.scale(1,-1);c.drawImage(b,0,0);return a.toDataURL()};function Sa(a){var c=[],b,d;if(da(a))return[W(ea(a))];if(1===U(a).length)for(a=Ta(a),b=0,d=a.length;b<d;b++)c[b]=W(a[b]);else if(2===U(a).length){b=U(a);var e=b[0];a=X(a,b[1]);b=0;for(d=a.length;b<d;b++)c[b]=Y(e,Sa(a[b]))}return c}function W(a){return"vec2 ("+a.a.toPrecision(8)+", "+a.b.toPrecision(8)+")"}
function Ua(a,c){a=Sa(a).reverse();for(var b=Va-a.length+1,d=W(S()),e=0;e<b;e++)a.push(d);c=["void f (in vec2 "+c+", out vec2 cs[N+1])","{"];for(b=0;b<=Va;b++)c.push("cs["+b+"] = "+a[b]+";");c.push("}");return c.join("\n")}function Wa(a,c,b){a=X(Xa(a,c),b);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=Y(c,Sa(a[e]));return["vec2 fx (in vec2 "+c+", in vec2 "+b+")","{","    return "+Y(b,d)+";","}"].join("\n")}
function Ya(a,c,b){a=X(Xa(a,b),c);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=Y(b,Sa(a[e]));return["vec2 fy (in vec2 "+c+", in vec2 "+b+")","{","    return "+Y(c,d)+";","}"].join("\n")}function Y(a,c){for(var b=c[0],d=1,e=c.length;d<e;d++)b="vec2 (1.0000000, 0.0000000)"===b?a:"vec2 (-1.0000000, 0.0000000)"===b?"-"+a:"cm ("+a+","+b+")","vec2 (0.0000000, 0.0000000)"!==c[d]&&(b+="+"+c[d]);return b}
function Za(a,c,b){var d,e,f,g,h=X(a,b);d=0;for(f=h.length;d<f;d++){var n=h[d].a;e=0;for(g=n.length;e<g;e++){var m=n[e];n[e]=new x(z(m.b.abs()),m.a)}h[d]=new v(n)}d=h[0];d=$a(d,c,V(d,c));a=$a(a,b,V(a,b));a=ab(Ta(a));b=["float M (in vec2 "+c+", in float rho)","{","    vec2 r = vec2 (length ("+c+") + rho, 0.0);","    float a["+h.length+"];","    a[0] = length ("+W(ea(d))+");"];d=0;for(f=a.length;d<f;d++)b.push("    a[0] *= distance ("+c+", "+W(a[d])+") - rho;");d=1;for(f=h.length;d<f;d++)b.push("    a["+
d+"] = length ("+Y("r",Sa(h[d]))+");");b=b.concat(["    float m = a[1] / a[0];","    for (int j = 2; j < "+h.length+"; j++) {","        m = max (m, pow (a[j] / a[0], 1.0 / float (j)));","    }","    return 2.0 * m;","}"]);return b.join("\n")}
function bb(a,c,b){var d=$a(a,b,V(a,b)),e=Xa(a,b);b=cb(b,a,e);e=b.a;(a=e.length)||console.error("matrix must be non-empty");for(var f=0;f<a;f++)e[f].length!==a&&console.error("matrix must be square");f=b;for(e=1;e<a;e++){for(var f=f.a,g=f[0][0].b(),h=[],n=0,m=f.length;n<m;n++){h[n]=[];for(var q=0;q<m;q++)if(q<n)h[n][q]=g;else if(q===n){for(var p=g,r=q+1;r<m;r++)var y=ba(f[r][r]),p=aa(p,y);h[n][q]=p}else h[n][q]=f[n][q]}f=(new db(h)).a;g=b.a;f[0].length!==g.length&&console.error("matrix dimensions must match");
h=[];n=f.length;m=g[0].length;q=f[0][0].b();for(p=0;p<n;p++)for(h[p]=[],r=0;r<m;r++){for(var y=q,w=0,D=f[0].length;w<D;w++)var t=ca(f[p][w],g[w][r]),y=aa(y,t);h[p][r]=y}f=new db(h)}b=f.a[0][0];a=a%2?b:ba(b);d=ab(Ta(d));f=ab(Ta(a));e=[];a=0;for(b=d.length;a<b;a++)isFinite(d[a].abs())&&e.push(d[a]);a=0;for(b=f.length;a<b;a++)isFinite(f[a].abs())&&e.push(f[a]);d=["float rho (in vec2 "+c+") {","    float d = 100.0;"];a=0;for(b=e.length;a<b;a++)d.push("    d = min (d, distance ("+c+", "+W(e[a])+"));");
d=d.concat(["    return 0.999 * d;","}"]);return d.join("\n")}var Va=8;
function Ra(a){var c=U(a),b=2>c.length?"x":c[0],c=c.length?c[c.length-1]:"y";return[["#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif","const int N = "+Va+";","const int sheets = "+V(a,c)+";","\n/* complex multiplication */\nvec2 cm (in vec2 a, in vec2 b)\n{\n    return vec2 (a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);\n}"].join("\n"),Ua(a,b),Wa(a,b,c),Ya(a,b,c),bb(a,b,c),Za(a,b,c)].join("\n\n")};function eb(a,c){var b=fb(),d=a.g;c.i=b.length/2;d.enableVertexAttribArray(0);c.U=d.createBuffer();Da(c,a);d.enableVertexAttribArray(1);this.b=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,this.b);d.bufferData(d.ARRAY_BUFFER,new Float32Array(b),d.STATIC_DRAW);c.H=d.createFramebuffer();b=N("Initial");b[0]=[c.D,b[0]].join("\n");b[1]=Ca(c,b[1]);this.a=O(a,b)}eb.prototype.b=null;eb.prototype.a=null;
eb.prototype.l=function(a,c,b){a=c.h;var d=c.m;b.useProgram(this.a);b.enableVertexAttribArray(0);b.bindBuffer(b.ARRAY_BUFFER,c.U);b.vertexAttribPointer(0,1,b.FLOAT,!1,0,0);b.enableVertexAttribArray(1);b.bindBuffer(b.ARRAY_BUFFER,this.b);b.vertexAttribPointer(1,2,b.FLOAT,!1,0,0);b.bindFramebuffer(b.FRAMEBUFFER,c.H);b.disable(b.DEPTH_TEST);b.viewport(0,0,2048,2048);for(var e=b.getUniformLocation(this.a,"computedRoots"),f=c.J,g,h=0;h<=f+1;h+=2)g=h<f?h/2+1:0,b.bindTexture(b.TEXTURE_2D,d[g]),b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,2048,2048,0,b.RGBA,b.FLOAT,null),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,d[g],0),b.uniform1i(e,h),b.drawArrays(b.POINTS,0,c.i);g=0;for(e=d.length;g<e;g++)b.activeTexture(b.TEXTURE0+g),b.bindTexture(b.TEXTURE_2D,null);
b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0);b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindBuffer(b.ARRAY_BUFFER,null);b.disableVertexAttribArray(1);c.h=d;c.m=a};function db(a){this.a=a}db.prototype.a=null;function fb(){for(var a=[],c=-10;10>c;c++)for(var b=-10;10>b;b++)a=(c+b)%2?a.concat([c,b,c+1,b+1,c,b+1,c,b,c+1,b,c+1,b+1]):a.concat([c,b,c+1,b,c,b+1,c+1,b,c+1,b+1,c,b+1]);return a.map(function(a){return a/2})};function gb(a,c,b){return a+b*(c-a)};function A(a){this.value=a}function hb(a){var c={};a=a.value;for(var b in a)c[b]=a[b];return new A(c)};function C(a){var c=arguments;return function(a){for(var b,e=[],f=0,g=c.length;f<g;f++)if(b=(0,c[f])(a))e.push(b);else return Array.prototype.unshift.apply(a,e),null;return e}}function la(a){var c=E("("),b=E(")");return function(d){return(d=C(c,a,b)(d))?d[1]:null}}function oa(a){return a.length?null:!0}function na(a){return function(c){return(c[0]||{}).type===a?c.shift():null}}function ja(a){return function(c){for(var b=a(c),d=[];null!==b;)d.push(b),b=a(c);return d}}
function ha(a){var c=arguments;return function(a){for(var b,e=0,f=c.length;e<f;e++)if(b=(0,c[e])(a))return b;return null}}function ia(a,c){return function(b){b=C(a,c)(b);return null===b?null:{type:"prefix",value:b[0].value,first:b[1]}}}function E(a){return function(c){return(c[0]||{}).value===a?c.shift():null}};function v(a){a.length?this.a=ib(a):this.a=[new x(S(),new A({}))]}function aa(a,c){return new v(ib(a.a.concat(c.a)))}function $a(a,c,b){a=a.a;for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e];if((g.a.value[c]||0)===b){var h=hb(g.a);delete h.value[c];d.push(new x(g.b,h))}}return new v(d)}function X(a,c){for(var b=V(a,c),d=[],e=0;e<=b;e++)d[e]=$a(a,c,b-e);return d}
function Ta(a){var c=U(a),b=c.length;1<b&&console.error("Polynomial is not univariate");a=X(a,0<b?c[0]:"x");for(var c=[],b=0,d=a.length;b<d;b++)c[b]=ea(a[b]);return c}function ea(a){var c=S();a=a.a;for(var b=0,d=a.length;b<d;b++){var e=a[b],f=e.a.value;f&&Object.keys(f).length||(c=P(c,e.b))}return c}function V(a,c){var b=0;a=a.a;for(var d=0,e=a.length;d<e;d++)b=Math.max(b,a[d].a.value[c]||0);return b}
function Xa(a,c){a=a.a;for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d].a,g=f.value[c]||0;if(0<g){var h=R(a[d].b,z(g)),f=hb(f);f.value[c]=g-1;b.push(new x(h,f))}}return new v(b)}function da(a){return!U(a).length&&!!a.a.length}
function jb(a,c,b){for(var d=a.length-1,e=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288],f,g,h,n,m=1;m<=b;m++){h=S();f=S();g=a[0];for(n=1;n<=d;n++)h=P(f,R(h,c)),f=P(g,R(f,c)),g=P(a[n],R(g,c));if(1E-14>g.abs())break;f=Q(f,g);n=R(f,f);g=T(n,Q(R(z(2),h),g));h=Qa(R(z(d-1),T(R(z(d),g),n)));g=P(f,h);f=T(f,h);g.abs()<f.abs()&&(g=f);f=1E-14<g.abs()?Q(z(d),g):R(z(c.abs()+1),new B(Math.cos(m),Math.sin(m)));if(1E-14>f.abs())break;!(m%20)&&m<b-19&&(f=R(f,z(e[Math.floor(m/20)])));c=T(c,f)}return c}
function ca(a,c){a=a.a;c=c.a;for(var b=[],d=0,e=a.length;d<e;d++)for(var f=0,g=c.length;f<g;f++){var h=a[d],n=c[f],m={},q=h.a.value,p=n.a.value,r=void 0;for(r in q)m[r]=q[r]+(p[r]||0);for(r in p)m[r]=p[r]+(q[r]||0);b.push(new x(R(h.b,n.b),new A(m)))}return new v(ib(b))}function ba(a){a=a.a;for(var c=[],b=0,d=a.length;b<d;b++){var e=a[b];c.push(new x(Pa(e.b),e.a))}return new v(c)}
function fa(a,c){var b=new v([new x(z(1),new A({}))]);for(Number.isInteger(c)||console.error("Non-integer power of Polynomial!");0<c;c--)b=ca(b,a);return b}v.prototype.pow=function(a){return fa(this,a)};function kb(a){var c=a[0],b=a[1];a=a[2];if(!a.a&&!a.b)return[S(),Pa(Q(b,c))];var d=Qa(T(R(b,b),R(z(4),R(c,a))));0<=b.a&&(d=Pa(d));return[Q(T(d,b),R(z(2),c)),Q(R(z(2),a),T(d,b))]}
function ab(a){var c=[],b=a,d=a.length-1;if(0>=d)return[];var e=a[0];if(!e.a&&!e.b)return c=ab(a.slice(1)),c.push(Oa),c;if(1===d)c[0]=Pa(Q(a[1],a[0]));else if(2===d)c=kb(a);else{for(e=0;e<d-2;e++){c[e]=jb(a,S(),200);c[e]=jb(b,c[e],1);for(var f=c[e],g=[a[0]],h=1,n=a.length-1;h<n;h++)g[h]=P(a[h],R(g[h-1],f));a=g}b=kb(a);c[d-2]=b[0];c[d-1]=b[1]}return c}
function cb(a,c,b){function d(a){for(var b=[],c=0;c<a;c++)b[c]=lb();return b}function e(a,b){return d(b).concat(a).concat(d(f+g-a.length-b))}var f=V(c,a),g=V(b,a);c=X(c,a);a=X(b,a);b=[];for(var h=0;h<g;h++)b.push(e(c,h));for(c=0;c<f;c++)b.push(e(a,c));return new db(b)}v.prototype.a=null;function U(a){a=a.a;for(var c=[],b={},d=0,e=a.length;d<e;d++){var f=a[d].a.value,g;for(g in f)b[g]||(c.push(g),b[g]=!0)}c.sort();return c}function lb(){return new v([])}v.prototype.b=lb;function Z(a,c,b,d){this.f=a;this.a=c;this.b=b;this.c=d}Z.prototype.abs=function(){return Math.sqrt(this.f*this.f+this.a*this.a+this.b*this.b+this.c*this.c)};function J(a,c){a=-a/2;c=-c/2;return mb(new Z(Math.cos(a),Math.sin(a),0,0),new Z(Math.cos(c),0,0,Math.sin(c)))}function nb(a,c,b){return new Z(gb(a.f,c.f,b),gb(a.a,c.a,b),gb(a.b,c.b,b),gb(a.c,c.c,b))}
function mb(a,c){return new Z(a.f*c.f-a.a*c.a-a.b*c.b-a.c*c.c,a.f*c.a+a.a*c.f+a.b*c.c-a.c*c.b,a.f*c.b-a.a*c.c+a.b*c.f+a.c*c.a,a.f*c.c+a.a*c.b-a.b*c.a+a.c*c.f)}function ob(a){var c=a.abs();return new Z(a.f/c,a.a/c,a.b/c,a.c/c)}function Ka(a){var c=a.f,b=a.a,d=a.b;a=a.c;return[c*c+b*b-d*d-a*a,2*b*d+2*c*a,2*b*a-2*c*d,0,2*b*d-2*c*a,c*c-b*b+d*d-a*a,2*d*a+2*c*b,0,2*b*a+2*c*d,2*d*a-2*c*b,c*c-b*b-d*d+a*a,0,0,0,0,c*c+b*b+d*d+a*a]}function xa(a,c){return new Z(a.f-c.f,a.a-c.a,a.b-c.b,a.c-c.c)};function pa(){}k=pa.prototype;k.o=!1;k.P=[0,0];k.B=!1;k.C=!1;k.j=J(0,0);k.R=J(0,0);k.s=J(0,0);k.F=1;function ua(a,c){a.o||(a.P=c,a.C=!0,a.R=a.s)}function va(a,c,b){if(a.C){var d=a.P;c-=d[0];b=d[1]-b;var d=Math.sqrt(c*c+b*b),e=a.R,f=d/Math.sqrt(1E4+d*d);a.s=ob(nb(e,mb(new Z(100/Math.sqrt(1E4+d*d),-f*b,f*c,0),e),.05))}}function ya(a){if(a.o){var c=ob(new Z(.01,0,0,1)),c=mb(c,c);a.j=a.s=mb(a.j,c)}else a.j=ob(nb(a.j,a.s,.1))};function qa(a){a=this.g=a.getContext("webgl",{preserveDrawingBuffer:!0});a.enable(a.DEPTH_TEST);a=this.g;var c=Math.min(a.getParameter(a.MAX_TEXTURE_SIZE),8192);this.V=c;this.I=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.I);a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),a.STATIC_DRAW);a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0);a.enableVertexAttribArray(0);this.Y=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,this.Y);this.Z=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,
this.Z);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,c,c);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.Z);this.A=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.A);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c,c,0,a.RGBA,a.UNSIGNED_BYTE,null);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.A,0);this.$=a.createFramebuffer();
a.bindFramebuffer(a.FRAMEBUFFER,this.$);this.aa=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,this.aa);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,2048,2048);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.aa);this.v=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.v);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2048,2048,0,a.RGBA,
a.UNSIGNED_BYTE,null);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.v,0);a.bindTexture(a.TEXTURE_2D,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindBuffer(a.ARRAY_BUFFER,null);this.ja=O(this,N("FXAA"))}k=qa.prototype;k.V=8192;k.L=!1;k.M=!0;k.ja=null;function pb(a,c){void 0===a[c]&&(a[c]=a.g.getExtension(c),a[c]||alert("Required extension "+c+" not supported. Please try another browser or platform."))}
function N(a){return[l[a+".vert"],l[a+".frag"]]}k.g=null;
function O(a,c){a=a.g;var b=c[1],d=a.createShader(a.VERTEX_SHADER);a.shaderSource(d,c[0]);a.compileShader(d);a.getShaderParameter(d,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(d));c=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(c,b);a.compileShader(c);a.getShaderParameter(c,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(c));b=a.createProgram();a.attachShader(b,d);a.attachShader(b,c);a.linkProgram(b);a.getProgramParameter(b,a.LINK_STATUS)||console.log(a.getProgramInfoLog(b));a.useProgram(b);
return b}
function L(a,c,b){var d;d=void 0===d?0:d;var e=a.g,f=e.getParameter(e.FRAMEBUFFER_BINDING),g=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,g);e.bindTexture(e.TEXTURE_2D,c);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,c,0);
if(e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE)return e.bindTexture(e.TEXTURE_2D,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),e.bindFramebuffer(e.FRAMEBUFFER,f),e.deleteFramebuffer(g),null;if(c===a.v)a=new Uint8Array(16777216),e.readPixels(0,0,2048,2048,e.RGBA,e.UNSIGNED_BYTE,a);else if(c===a.A)c=a.V,a=new Uint8Array(4*c*c),e.readPixels(0,0,c,c,e.RGBA,e.UNSIGNED_BYTE,a);else{a=new Float32Array(16777216);if(e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)!==
e.FLOAT)return console.error("Reading from float textures not supported. Please try another browser or platform."),null;e.readPixels(0,0,2048,2048,e.RGBA,e.FLOAT,a)}c=e.getError();e.bindTexture(e.TEXTURE_2D,null);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0);e.bindFramebuffer(e.FRAMEBUFFER,f);e.deleteFramebuffer(g);return c!==e.NO_ERROR?null:b?a.subarray(d,d+b):a}k.w=null;function wa(a,c){var b=a.g;qb(a,function(){a.w.l(a,b,c)})}k.I=null;k.Y=null;k.Z=null;k.A=null;
k.$=null;k.aa=null;k.v=null;k.S=!1;function Ia(a){var c=a.g;c.uniform1f(c.getUniformLocation(c.getParameter(c.CURRENT_PROGRAM),"clipping"),a.L?1:0)}
function Ma(a,c){var b=a.g,d=b.getParameter(b.VIEWPORT),b=d[2],d=d[3];if(c.B){var e=c.F;c=-7.5*e;var f=-7.5*e,g=7.5*e,e=7.5*e,h=Math.min(d/b,1),b=Math.min(b/d,1),b=[2*h/(g-f),0,0,0,0,2*b/(e-c),0,0,0,0,-.01,0,-h*(g+f)/(g-f),-b*(e+c)/(e-c),-0,1]}else c=1/Math.tan(45*c.F/2*Math.PI/180),b=[c/(0<d?b/d:b),0,0,0,0,c,0,0,0,0,101/-99,-1,0,0,200/-99,0];Ja(a,"p",b)}
function Na(a,c){var b=a.g;a.S&&!1!==c?(b.blendFunc(b.SRC_ALPHA,b.ONE),b.enable(b.BLEND),b.disable(b.DEPTH_TEST)):(b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.depthFunc(b.LESS))}function Ja(a,c,b){a=a.g;a.uniformMatrix4fv(a.getUniformLocation(a.getParameter(a.CURRENT_PROGRAM),c),!1,b)}function La(a,c){Ja(a,"v",c.B?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-20,1])}
function qb(a,c){if(a.M){sa(a,c);c=a.g;var b=a.ja;c.useProgram(b);var d=c.getUniformLocation(b,"width");c.uniform1f(d,c.canvas.width);d=c.getUniformLocation(b,"height");c.uniform1f(d,c.canvas.height);c.bindBuffer(c.ARRAY_BUFFER,a.I);c.vertexAttribPointer(0,2,c.FLOAT,!1,0,0);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,a.v);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);c.drawArrays(c.TRIANGLES,0,3)}else c()}
function sa(a,c,b){var d=a.g;(void 0===b?0:b)?(b=a.V,d.bindFramebuffer(d.FRAMEBUFFER,a.Y),d.viewport(0,0,b,b)):(d.bindFramebuffer(d.FRAMEBUFFER,a.$),d.viewport(0,0,2048,2048));c();d.viewport(0,0,d.canvas.width,d.canvas.height);d.bindFramebuffer(d.FRAMEBUFFER,null)};function rb(a,c){var b=N("Subdivision");b[0]=[c.D,b[0]].join("\n");b[1]=Ca(c,b[1]);this.a=O(a,b)}rb.prototype.a=null;
rb.prototype.l=function(a,c,b){var d,e=c.h,f=c.m,g=this.a;b.useProgram(g);var h=L(a,e[0]),n=[0,1,0,0,1,0,1,0,2,0,0,1,0,1,0,0,1,0,1,0,2,.5,0,.5,3,0,1,0,4,0,0,1,5,.5,0,.5,0,1,0,0,1,0,1,0,2,0,.5,.5,3,0,.5,.5,4,0,0,1,5,1,0,0,0,1,0,0,1,0,1,0,2,.5,0,.5,3,0,.5,.5,4,0,0,1,5,.5,0,.5,6,.5,0,.5,7,0,1,0,8,0,.5,.5,0,1,0,0,1,.5,.5,0,2,0,0,1,3,0,0,1,4,.5,.5,0,5,0,1,0,0,1,0,0,1,.5,.5,0,2,.5,0,.5,3,.5,0,.5,4,.5,.5,0,5,0,0,1,6,0,1,0,7,0,0,1,8,.5,.5,0,0,1,0,0,1,.5,.5,0,2,0,.5,.5,3,0,0,1,4,1,0,0,5,0,.5,.5,6,0,.5,.5,
7,.5,.5,0,8,0,1,0,0,1,0,0,1,.5,.5,0,2,.5,0,.5,3,.5,.5,0,4,0,1,0,5,0,.5,.5,6,0,.5,.5,7,0,0,1,8,.5,0,.5,9,.5,.5,0,10,0,.5,.5,11,.5,0,.5],m=[0,3,9,15,24,30,39,48],q=[3,6,6,9,6,9,9,12];b.bindFramebuffer(b.FRAMEBUFFER,c.H);var p=[];a=0;for(d=e.length;a<d;a++)b.activeTexture(b.TEXTURE0+a),b.bindTexture(b.TEXTURE_2D,e[a]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),p[a]=a;b.uniform1iv(b.getUniformLocation(g,"oldSamplers"),p);b.disable(b.DEPTH_TEST);b.viewport(0,0,2048,2048);var g=b.getUniformLocation(this.a,"computedRoots"),p=c.J,r=[],y=[],w=[],D=0;a=0;for(d=c.i/3;a<d;a++){var t=4*h[12*a+3]+2*h[12*a+7]+h[12*a+11],H=m[t],t=q[t];w.push(n.slice(4*H,4*(H+t)));for(H=0;H<t;H++)r.push(3*a),y.push(D);D+=t}w=Array.prototype.concat.apply([],w);h=b.createBuffer();b.enableVertexAttribArray(0);b.bindBuffer(b.ARRAY_BUFFER,
h);b.bufferData(b.ARRAY_BUFFER,new Float32Array(w),b.STATIC_DRAW);b.vertexAttribPointer(0,4,b.FLOAT,!1,0,0);n=b.createBuffer();b.enableVertexAttribArray(1);b.bindBuffer(b.ARRAY_BUFFER,n);b.bufferData(b.ARRAY_BUFFER,new Float32Array(r),b.STATIC_DRAW);b.vertexAttribPointer(1,1,b.FLOAT,!1,0,0);m=b.createBuffer();b.enableVertexAttribArray(2);b.bindBuffer(b.ARRAY_BUFFER,m);b.bufferData(b.ARRAY_BUFFER,new Float32Array(y),b.STATIC_DRAW);b.vertexAttribPointer(2,1,b.FLOAT,!1,0,0);for(d=0;d<=p+1;d+=2)a=d<p?
d/2+1:0,b.activeTexture(b.TEXTURE0+e.length),b.bindTexture(b.TEXTURE_2D,f[a]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,2048,2048,0,b.RGBA,b.FLOAT,null),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,f[a],0),b.uniform1i(g,d),b.drawArrays(b.POINTS,0,D);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0);a=0;for(d=e.length+1;a<d;a++)b.activeTexture(b.TEXTURE0+
a),b.bindTexture(b.TEXTURE_2D,null);b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindBuffer(b.ARRAY_BUFFER,null);b.deleteBuffer(n);b.deleteBuffer(m);b.deleteBuffer(h);b.disableVertexAttribArray(1);b.disableVertexAttribArray(2);c.i=D;c.h=f;c.m=e};function sb(a,c){var b=N("SubdivisionPre");b[0]=[c.D,b[0]].join("\n");this.a=O(a,b)}sb.prototype.a=null;
sb.prototype.l=function(a,c,b){var d=c.h[0],e=c.m[0];b.useProgram(this.a);Da(c,a);b.vertexAttribPointer(0,1,b.FLOAT,!1,0,0);b.bindFramebuffer(b.FRAMEBUFFER,c.H);b.bindTexture(b.TEXTURE_2D,e);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,e,0);b.bindTexture(b.TEXTURE_2D,null);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,d);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.uniform1i(b.getUniformLocation(this.a,"sampler"),0);b.disable(b.DEPTH_TEST);b.viewport(0,0,2048,2048);b.drawArrays(b.POINTS,0,c.i);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0);b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindBuffer(b.ARRAY_BUFFER,null);c.h[0]=e;c.m[0]=d};function za(a,c,b){pb(a,"OES_texture_float");var d=a.g;-1!==d.getSupportedExtensions().indexOf("WEBGL_color_buffer_float")&&pb(a,"WEBGL_color_buffer_float");for(var e=a.g,f=[],g=[],h=0;5>h;h++)f[h]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,f[h]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2048,2048,0,e.RGBA,e.FLOAT,null),g[h]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,g[h]),e.texParameteri(e.TEXTURE_2D,
e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2048,2048,0,e.RGBA,e.FLOAT,null);e.bindTexture(e.TEXTURE_2D,null);this.h=f;this.m=g;e=this.h[0];f=a.g;g=f.getParameter(f.FRAMEBUFFER_BINDING);h=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,h);var n=f.createRenderbuffer();f.bindRenderbuffer(f.RENDERBUFFER,n);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,2048,2048);f.framebufferRenderbuffer(f.FRAMEBUFFER,
f.DEPTH_ATTACHMENT,f.RENDERBUFFER,n);f.bindTexture(f.TEXTURE_2D,e);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,e,0);var m=f.checkFramebufferStatus(f.FRAMEBUFFER),q=f.getError(),m=m===f.FRAMEBUFFER_COMPLETE&&q===f.NO_ERROR;f.bindTexture(f.TEXTURE_2D,
null);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,null,0);f.bindRenderbuffer(f.RENDERBUFFER,null);f.deleteRenderbuffer(n);f.bindFramebuffer(f.FRAMEBUFFER,g);f.deleteFramebuffer(h);e=!!L(a,e);m&&e?e=!0:(alert((m||e?m?"Reading from float textures not supported.":"Rendering to float textures not supported.":"Rendering to and reading from float textures not supported.")+" Please try another browser or platform."),e=!1);if(e){this.a=c;this.b=b;b=this.a;e=U(b);this.J=V(b,e.length?
e[e.length-1]:"y");this.ha=l["Common.glsl"];this.ia=Ra(c);this.D=l["Textures.glsl"];this.f=new eb(a,this);this.f.l(a,this,d);this.O=new sb(a,this);this.N=new rb(a,this);for(c=0;c<this.b;c++)this.O.l(a,this,d),this.N.l(a,this,d);this.c=new Ba(a,this);this.c.l(a,this,d);c=N("Surface");c[0]=[this.D,c[0]].join("\n");c[1]=Ca(this,c[1]);this.K=O(a,c);a=d.canvas;d.viewport(0,0,a.width,a.height)}}k=za.prototype;k.ha="";k.ia="";k.ba=function(a,c){return Fa(this.a,a,void 0===c?!1:c)};
k.ca=function(a,c){c=void 0===c?"surface.bin":c;a=L(a,this.h[0],4*this.i);a=URL.createObjectURL(new Blob([a],{type:"application/octet-binary"}));M(c,a)};k.da=function(a,c,b){Ga(this.a,a,void 0===c?"sheet":c,void 0===b?!0:b)};k.ea=function(a,c,b){c=void 0===c?"surface":c;b=void 0===b?!0:b;var d=L(a,this.h[0],4*this.i);Ha(a,d,c,b)};function Da(a,c){c=c.g;for(var b=[],d=0;d<a.i;d++)b[d]=d;c.bindBuffer(c.ARRAY_BUFFER,a.U);c.bufferData(c.ARRAY_BUFFER,new Float32Array(b),c.STATIC_DRAW)}k.H=null;k.U=null;
k.i=0;k.K=null;
k.l=function(a,c,b){this.K&&(c.useProgram(this.K),Ia(a),Ja(a,"m",Ka(b.j)),La(a,b),Ma(a,b),Na(a),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,this.h[0]),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.uniform1i(c.getUniformLocation(this.K,"sampler"),0),Da(this,a),c.vertexAttribPointer(0,1,
c.FLOAT,!1,0,0),c.enable(c.DEPTH_TEST),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),c.drawArrays(c.TRIANGLES,0,this.i),Na(a,!1))};k.J=0;k.h=[];k.m=[];k.D="";function Ca(a,c){return[a.ia,a.ha,c].join("\n")};function x(a,c){this.b=a;this.a=c}x.prototype.b=null;x.prototype.a=null;
function ib(a){function c(a,d){if(d.length){if(1===d.length)return a.push(d[0]),a;for(var b=d.pop(),f=b.b,b=b.a,g=[],h=0,n=d.length;h<n;h++){var m;a:{m=b;var q=d[h].a,p=void 0;for(p in m.value)if(!q.value.hasOwnProperty(p)||m.value[p]!==q.value[p]){m=!1;break a}for(p in q.value)if(!m.value.hasOwnProperty(p)||m.value[p]!==q.value[p]){m=!1;break a}m=!0}m?f=P(f,d[h].b):g.push(d[h])}a.push(new x(f,b));return c(a,g)}return a}return c([],a)};function tb(){this.a=[["\\d*\\.\\d*","number"],["\\d+","number"],["i","imaginary"],["[a-hj-z]","variable"],["[\\+\\*\\^-]","operator"],["[\\(\\)]","parenthesis"]]}function ma(a){for(var c=(new tb).a,b="(?:",d=0,e=c.length;d<e;d++)b+=(0<d?"|(":"(")+c[d][0]+")";b=new RegExp(b+")","g");for(d=[];e=b.exec(a);){var f=e[0];d.push({type:c[e.slice(1).indexOf(f)][1],value:f})}return d};
})();//# sourceMappingURL=ComplexCurves.js.map

